summary_dir /afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=2
use_gpu True
save_model True
load_model False
random_seed 1754
buffer_size 1000000
max_episodes 200
max_episode_len 1464
mini_batch_size 300
actor_lr 0.0001
critic_lr 0.001
gamma 0.99
noise_var 0.0925
scaling True
state_dim 2
action_dim 1
action_bound [1.]
discretization_time 0.001
T_set_max_min [23.0, 26.0]
T_max_min [22.0, 23.0]
time_steps 2
actor_rnn 10
actor_l1 50
actor_l2 40
critic_rnn 10
critic_l1 50
critic_l2 20
tau 0.001
{'T_max_min': [22.0, 23.0],
 'T_set_max_min': [23.0, 26.0],
 'action_bound': array([1.], dtype=float32),
 'action_dim': 1,
 'actor_l1': 50,
 'actor_l2': 40,
 'actor_lr': 0.0001,
 'actor_rnn': 10,
 'buffer_size': 1000000,
 'critic_l1': 50,
 'critic_l2': 20,
 'critic_lr': 0.001,
 'critic_rnn': 10,
 'discretization_time': 0.001,
 'gamma': 0.99,
 'load_model': False,
 'max_episode_len': 1464,
 'max_episodes': 200,
 'mini_batch_size': 300,
 'noise_var': 0.0925,
 'random_seed': 1754,
 'save_model': True,
 'scaling': True,
 'state_dim': 2,
 'summary_dir': '/afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=2',
 'tau': 0.001,
 'time_steps': 2,
 'use_gpu': True}
starting the scaling
finished the scaling
[0.47910478 0.02820314] [ 24.00027178 -28.56908167]
initalizing the actor and critic func
loading the weights
Model: "actor_network"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
actor_input_state (InputLaye [(None, 2, 2)]            0         
_________________________________________________________________
conv1d (Conv1D)              (None, 1, 16)             80        
_________________________________________________________________
actor_rnn (GRU)              (None, 10)                840       
_________________________________________________________________
actor_dense_1 (Dense)        (None, 50)                550       
_________________________________________________________________
batch_normalization (BatchNo (None, 50)                200       
_________________________________________________________________
activation (Activation)      (None, 50)                0         
_________________________________________________________________
actor_dense_2 (Dense)        (None, 40)                2040      
_________________________________________________________________
batch_normalization_1 (Batch (None, 40)                160       
_________________________________________________________________
activation_1 (Activation)    (None, 40)                0         
_________________________________________________________________
actor_dense_3 (Dense)        (None, 1)                 41        
_________________________________________________________________
tf_op_layer_actions_scaling  [(None, 1)]               0         
=================================================================
Total params: 3,911
Trainable params: 3,731
Non-trainable params: 180
_________________________________________________________________
None
Model: "critic_network"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
critic_input_state (InputLayer) [(None, 2, 2)]       0                                            
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, 1, 16)        80          critic_input_state[0][0]         
__________________________________________________________________________________________________
gru (GRU)                       (None, 10)           840         conv1d_2[0][0]                   
__________________________________________________________________________________________________
critic_dense_1 (Dense)          (None, 50)           550         gru[0][0]                        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 50)           200         critic_dense_1[0][0]             
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 50)           0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
critic_input_action (InputLayer [(None, 1)]          0                                            
__________________________________________________________________________________________________
critic_dense_2_state (Dense)    (None, 20)           1020        activation_4[0][0]               
__________________________________________________________________________________________________
critic_dense_2_action (Dense)   (None, 20)           40          critic_input_action[0][0]        
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 40)           0           critic_dense_2_state[0][0]       
                                                                 critic_dense_2_action[0][0]      
__________________________________________________________________________________________________
critic_dense_3_state (Dense)    (None, 20)           820         concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 20)           80          critic_dense_3_state[0][0]       
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 20)           0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
Q_val (Dense)                   (None, 1)            21          activation_5[0][0]               
==================================================================================================
Total params: 3,651
Trainable params: 3,511
Non-trainable params: 140
__________________________________________________________________________________________________
None
starting the simulation
running - train_rnn_cbf
| Reward: 11298.9005 | Episode: 0 | Qmax: 10.1638
| Reward: 11298.8088 | Episode: 1 | Qmax: 19.0806
| Reward: 11300.1136 | Episode: 2 | Qmax: 32.6084
| Reward: 11303.6442 | Episode: 3 | Qmax: 54.7926
| Reward: 11303.3953 | Episode: 4 | Qmax: 97.9758
| Reward: 11303.1119 | Episode: 5 | Qmax: 187.7277
| Reward: 11303.2505 | Episode: 6 | Qmax: 363.1748
| Reward: 11302.9331 | Episode: 7 | Qmax: 645.5702
| Reward: 11302.7675 | Episode: 8 | Qmax: 1051.0723
| Reward: 11303.1859 | Episode: 9 | Qmax: 1572.1794
| Reward: 11302.7018 | Episode: 10 | Qmax: 2120.7791
| Reward: 11302.7186 | Episode: 11 | Qmax: 2661.9912
| Reward: 11303.0658 | Episode: 12 | Qmax: 3203.1406
| Reward: 11303.2422 | Episode: 13 | Qmax: 3729.9884
| Reward: 11302.8558 | Episode: 14 | Qmax: 4238.8395
| Reward: 11303.0956 | Episode: 15 | Qmax: 4710.9151
| Reward: 11303.3100 | Episode: 16 | Qmax: 5134.0795
| Reward: 11302.8766 | Episode: 17 | Qmax: 5481.7486
| Reward: 11302.8773 | Episode: 18 | Qmax: 5822.3804
| Reward: 11303.2934 | Episode: 19 | Qmax: 6159.4140
| Reward: 11303.1918 | Episode: 20 | Qmax: 6488.5891
| Reward: 11302.9076 | Episode: 21 | Qmax: 6810.1392
| Reward: 11303.1197 | Episode: 22 | Qmax: 7131.3425
| Reward: 11303.3117 | Episode: 23 | Qmax: 7454.7757
| Reward: 11303.0816 | Episode: 24 | Qmax: 7516.6331
| Reward: 11303.7480 | Episode: 25 | Qmax: 7298.2329
| Reward: 11302.9206 | Episode: 26 | Qmax: 7092.2655
| Reward: 11302.6538 | Episode: 27 | Qmax: 6913.2207
| Reward: 11303.3631 | Episode: 28 | Qmax: 6748.4845
| Reward: 11302.7191 | Episode: 29 | Qmax: 6597.3453
| Reward: 11303.3961 | Episode: 30 | Qmax: 6460.5588
| Reward: 11303.3785 | Episode: 31 | Qmax: 6339.0398
| Reward: 11303.1185 | Episode: 32 | Qmax: 6222.5849
| Reward: 11302.8648 | Episode: 33 | Qmax: 6116.2839
| Reward: 11302.7618 | Episode: 34 | Qmax: 6017.2658
| Reward: 11303.2424 | Episode: 35 | Qmax: 5924.7947
| Reward: 11302.6084 | Episode: 36 | Qmax: 5838.7112
| Reward: 11302.6627 | Episode: 37 | Qmax: 5758.4037
| Reward: 11302.9434 | Episode: 38 | Qmax: 5686.3176
| Reward: 11303.2132 | Episode: 39 | Qmax: 5620.5161
| Reward: 11302.9656 | Episode: 40 | Qmax: 5559.3034
| Reward: 11303.1710 | Episode: 41 | Qmax: 5505.8740
| Reward: 11302.9919 | Episode: 42 | Qmax: 5458.0104
| Reward: 11302.8872 | Episode: 43 | Qmax: 5416.4436
| Reward: 11303.1244 | Episode: 44 | Qmax: 5382.9766
| Reward: 11303.2239 | Episode: 45 | Qmax: 5352.6199
| Reward: 11303.5727 | Episode: 46 | Qmax: 5330.3574
| Reward: 11302.8213 | Episode: 47 | Qmax: 5314.4338
| Reward: 11303.4129 | Episode: 48 | Qmax: 5300.6910
| Reward: 11302.8855 | Episode: 49 | Qmax: 5296.5251
| Reward: 11302.9726 | Episode: 50 | Qmax: 5296.5777
| Reward: 11303.2096 | Episode: 51 | Qmax: 5299.9752
| Reward: 11303.2714 | Episode: 52 | Qmax: 5311.2823
| Reward: 11302.9026 | Episode: 53 | Qmax: 5325.3768
| Reward: 11302.9359 | Episode: 54 | Qmax: 5346.6670
| Reward: 11303.5081 | Episode: 55 | Qmax: 5370.7713
| Reward: 11302.7533 | Episode: 56 | Qmax: 5400.1491
| Reward: 11302.7414 | Episode: 57 | Qmax: 5434.8256
| Reward: 11303.5286 | Episode: 58 | Qmax: 5473.2129
| Reward: 11302.6957 | Episode: 59 | Qmax: 5517.1140
| Reward: 11303.0637 | Episode: 60 | Qmax: 5567.1777
| Reward: 11303.2267 | Episode: 61 | Qmax: 5618.9743
| Reward: 11302.7993 | Episode: 62 | Qmax: 5675.5068
| Reward: 11303.2982 | Episode: 63 | Qmax: 5738.9037
| Reward: 11303.3208 | Episode: 64 | Qmax: 5806.1341
| Reward: 11303.3172 | Episode: 65 | Qmax: 5877.4981
| Reward: 11303.2767 | Episode: 66 | Qmax: 5954.3865
| Reward: 11303.3914 | Episode: 67 | Qmax: 6033.7615
| Reward: 11303.0909 | Episode: 68 | Qmax: 6114.5694
| Reward: 11303.5575 | Episode: 69 | Qmax: 6203.4103
| Reward: 11303.1779 | Episode: 70 | Qmax: 6296.6235
| Reward: 11303.0273 | Episode: 71 | Qmax: 6388.8641
| Reward: 11303.3035 | Episode: 72 | Qmax: 6479.9126
| Reward: 11303.5345 | Episode: 73 | Qmax: 6587.8974
| Reward: 11303.1702 | Episode: 74 | Qmax: 6699.5388
| Reward: 11302.8172 | Episode: 75 | Qmax: 6813.7411
| Reward: 11303.2528 | Episode: 76 | Qmax: 6932.7909
| Reward: 11303.0498 | Episode: 77 | Qmax: 7060.4242
| Reward: 11302.9562 | Episode: 78 | Qmax: 7185.6910
| Reward: 11303.2194 | Episode: 79 | Qmax: 7312.6090
| Reward: 11303.1167 | Episode: 80 | Qmax: 7446.6608
| Reward: 11302.7671 | Episode: 81 | Qmax: 7584.4491
| Reward: 11302.8734 | Episode: 82 | Qmax: 7731.1934
| Reward: 11303.1781 | Episode: 83 | Qmax: 7884.0394
| Reward: 11302.8779 | Episode: 84 | Qmax: 8037.7176
| Reward: 11303.4347 | Episode: 85 | Qmax: 8199.9793
| Reward: 11303.2443 | Episode: 86 | Qmax: 8365.9113
| Reward: 11302.9827 | Episode: 87 | Qmax: 8529.0310
| Reward: 11303.0615 | Episode: 88 | Qmax: 8700.6573
| Reward: 11302.9137 | Episode: 89 | Qmax: 8866.3815
| Reward: 11303.3357 | Episode: 90 | Qmax: 9051.7290
| Reward: 11302.9120 | Episode: 91 | Qmax: 9228.6851
| Reward: 11302.9849 | Episode: 92 | Qmax: 9413.8947
| Reward: 11302.8380 | Episode: 93 | Qmax: 9607.9843
| Reward: 11303.0325 | Episode: 94 | Qmax: 9677.2876
| Reward: 11303.4112 | Episode: 95 | Qmax: 9408.8892
| Reward: 11303.1347 | Episode: 96 | Qmax: 9239.6367
| Reward: 11303.3785 | Episode: 97 | Qmax: 9078.3421
| Reward: 11303.0008 | Episode: 98 | Qmax: 8932.3110
| Reward: 11302.8161 | Episode: 99 | Qmax: 8790.7870
| Reward: 11303.2566 | Episode: 100 | Qmax: 8661.7725
| Reward: 11303.3307 | Episode: 101 | Qmax: 8535.5552
| Reward: 11302.9929 | Episode: 102 | Qmax: 8413.4080
| Reward: 11303.5588 | Episode: 103 | Qmax: 8291.1833
| Reward: 11303.0984 | Episode: 104 | Qmax: 8169.9376
| Reward: 11303.1231 | Episode: 105 | Qmax: 8047.6529
| Reward: 11302.9380 | Episode: 106 | Qmax: 7939.0949
| Reward: 11302.9055 | Episode: 107 | Qmax: 7839.2833
| Reward: 11302.8021 | Episode: 108 | Qmax: 7728.9081
| Reward: 11302.9261 | Episode: 109 | Qmax: 7628.3954
| Reward: 11303.2488 | Episode: 110 | Qmax: 7519.7669
| Reward: 11303.0974 | Episode: 111 | Qmax: 7398.3222
| Reward: 11303.1265 | Episode: 112 | Qmax: 7291.3701
| Reward: 11303.7752 | Episode: 113 | Qmax: 7190.9519
| Reward: 11302.7224 | Episode: 114 | Qmax: 7087.2944
| Reward: 11302.9368 | Episode: 115 | Qmax: 6993.8707
| Reward: 11302.9157 | Episode: 116 | Qmax: 6890.8933
| Reward: 11303.3780 | Episode: 117 | Qmax: 6798.2228
| Reward: 11303.3258 | Episode: 118 | Qmax: 6706.7298
| Reward: 11303.0258 | Episode: 119 | Qmax: 6615.7132
| Reward: 11303.5212 | Episode: 120 | Qmax: 6531.8386
| Reward: 11303.0716 | Episode: 121 | Qmax: 6452.0777
| Reward: 11303.1347 | Episode: 122 | Qmax: 6373.4447
| Reward: 11303.3648 | Episode: 123 | Qmax: 6280.4517
| Reward: 11302.8359 | Episode: 124 | Qmax: 6202.2224
| Reward: 11303.3033 | Episode: 125 | Qmax: 6118.2339
| Reward: 11303.2927 | Episode: 126 | Qmax: 6053.4118
| Reward: 11303.0691 | Episode: 127 | Qmax: 5966.2211
| Reward: 11303.3247 | Episode: 128 | Qmax: 5859.7000
| Reward: 11303.1384 | Episode: 129 | Qmax: 5773.9104
| Reward: 11302.9588 | Episode: 130 | Qmax: 5706.4474
| Reward: 11303.2107 | Episode: 131 | Qmax: 5623.4726
| Reward: 11302.9443 | Episode: 132 | Qmax: 5545.7963
| Reward: 11302.7264 | Episode: 133 | Qmax: 5472.5863
| Reward: 11303.3438 | Episode: 134 | Qmax: 5401.2026
| Reward: 11303.2268 | Episode: 135 | Qmax: 5330.6168
| Reward: 11302.7639 | Episode: 136 | Qmax: 5264.7220
| Reward: 11303.3780 | Episode: 137 | Qmax: 5202.8286
| Reward: 11303.2093 | Episode: 138 | Qmax: 5129.6545
| Reward: 11303.3670 | Episode: 139 | Qmax: 5062.3131
| Reward: 11302.9809 | Episode: 140 | Qmax: 4989.7486
| Reward: 11302.3013 | Episode: 141 | Qmax: 4929.2561
| Reward: 11302.9225 | Episode: 142 | Qmax: 4864.9501
| Reward: 11303.1223 | Episode: 143 | Qmax: 4799.6911
| Reward: 11303.6285 | Episode: 144 | Qmax: 4739.5559
| Reward: 11303.1608 | Episode: 145 | Qmax: 4676.3797
| Reward: 11303.0132 | Episode: 146 | Qmax: 4619.1901
| Reward: 11303.4645 | Episode: 147 | Qmax: 4561.6848
| Reward: 11302.8238 | Episode: 148 | Qmax: 4499.7832
| Reward: 11303.2402 | Episode: 149 | Qmax: 4437.0681
| Reward: 11302.8323 | Episode: 150 | Qmax: 4377.5002
| Reward: 11302.9166 | Episode: 151 | Qmax: 4322.8046
| Reward: 11302.6229 | Episode: 152 | Qmax: 4254.7085
| Reward: 11303.4514 | Episode: 153 | Qmax: 4199.4652
| Reward: 11303.1731 | Episode: 154 | Qmax: 4160.9827
| Reward: 11303.3094 | Episode: 155 | Qmax: 4099.7328
| Reward: 11302.9859 | Episode: 156 | Qmax: 4053.8074
| Reward: 11302.9987 | Episode: 157 | Qmax: 3993.9985
| Reward: 11302.5666 | Episode: 158 | Qmax: 3950.2307
| Reward: 11303.1639 | Episode: 159 | Qmax: 3899.1493
| Reward: 11303.0272 | Episode: 160 | Qmax: 3854.6705
| Reward: 11303.2742 | Episode: 161 | Qmax: 3803.0718
| Reward: 11303.5978 | Episode: 162 | Qmax: 3766.9623
| Reward: 11302.9778 | Episode: 163 | Qmax: 3714.1778
| Reward: 11303.7839 | Episode: 164 | Qmax: 3686.6579
| Reward: 11303.1586 | Episode: 165 | Qmax: 3656.6780
| Reward: 11302.7642 | Episode: 166 | Qmax: 3618.1972
| Reward: 11303.7734 | Episode: 167 | Qmax: 3564.5642
| Reward: 11303.7083 | Episode: 168 | Qmax: 3490.8840
| Reward: 11303.2584 | Episode: 169 | Qmax: 3476.9425
| Reward: 11303.1370 | Episode: 170 | Qmax: 3423.9336
| Reward: 11303.5185 | Episode: 171 | Qmax: 3366.5360
| Reward: 11303.3996 | Episode: 172 | Qmax: 3318.8348
| Reward: 11303.1093 | Episode: 173 | Qmax: 3280.6057
| Reward: 11302.8955 | Episode: 174 | Qmax: 3241.1422
| Reward: 11303.0213 | Episode: 175 | Qmax: 3204.1455
| Reward: 11303.1829 | Episode: 176 | Qmax: 3168.4027
| Reward: 11303.2944 | Episode: 177 | Qmax: 3132.9755
| Reward: 11302.9399 | Episode: 178 | Qmax: 3097.2441
| Reward: 11302.8191 | Episode: 179 | Qmax: 3063.5236
| Reward: 11303.7054 | Episode: 180 | Qmax: 3028.6972
| Reward: 11302.8606 | Episode: 181 | Qmax: 2994.5731
| Reward: 11303.3463 | Episode: 182 | Qmax: 2963.2903
| Reward: 11303.0605 | Episode: 183 | Qmax: 2928.0200
| Reward: 11303.0311 | Episode: 184 | Qmax: 2894.3796
| Reward: 11303.2285 | Episode: 185 | Qmax: 2862.6185
| Reward: 11303.2092 | Episode: 186 | Qmax: 2831.5069
| Reward: 11303.1205 | Episode: 187 | Qmax: 2800.1955
| Reward: 11302.9939 | Episode: 188 | Qmax: 2769.4213
| Reward: 11303.2452 | Episode: 189 | Qmax: 2739.6607
| Reward: 11302.8943 | Episode: 190 | Qmax: 2710.7657
| Reward: 11303.4638 | Episode: 191 | Qmax: 2682.1149
| Reward: 11303.6473 | Episode: 192 | Qmax: 2653.5915
| Reward: 11302.9317 | Episode: 193 | Qmax: 2625.1128
| Reward: 11303.0514 | Episode: 194 | Qmax: 2597.4990
| Reward: 11303.5130 | Episode: 195 | Qmax: 2572.0096
| Reward: 11303.5955 | Episode: 196 | Qmax: 2556.9861
| Reward: 11302.9147 | Episode: 197 | Qmax: 2544.9151
| Reward: 11303.0183 | Episode: 198 | Qmax: 2539.2610
| Reward: 11303.1280 | Episode: 199 | Qmax: 2483.2481
saving weights
Plotting an new testing environment
