summary_dir /afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=7
use_gpu True
save_model True
load_model False
random_seed 1754
buffer_size 1000000
max_episodes 200
max_episode_len 1464
mini_batch_size 300
actor_lr 0.0001
critic_lr 0.001
gamma 0.99
noise_var 0.0925
scaling True
state_dim 2
action_dim 1
action_bound [1.]
discretization_time 0.001
T_set_max_min [23.0, 26.0]
T_max_min [22.0, 25.0]
time_steps 7
actor_rnn 10
actor_l1 50
actor_l2 40
critic_rnn 10
critic_l1 50
critic_l2 20
tau 0.001
{'T_max_min': [22.0, 25.0],
 'T_set_max_min': [23.0, 26.0],
 'action_bound': array([1.], dtype=float32),
 'action_dim': 1,
 'actor_l1': 50,
 'actor_l2': 40,
 'actor_lr': 0.0001,
 'actor_rnn': 10,
 'buffer_size': 1000000,
 'critic_l1': 50,
 'critic_l2': 20,
 'critic_lr': 0.001,
 'critic_rnn': 10,
 'discretization_time': 0.001,
 'gamma': 0.99,
 'load_model': False,
 'max_episode_len': 1464,
 'max_episodes': 200,
 'mini_batch_size': 300,
 'noise_var': 0.0925,
 'random_seed': 1754,
 'save_model': True,
 'scaling': True,
 'state_dim': 2,
 'summary_dir': '/afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=7',
 'tau': 0.001,
 'time_steps': 7,
 'use_gpu': True}
starting the scaling
finished the scaling
[0.48387517 0.02817287] [ 24.00361951 -28.56378309]
initalizing the actor and critic func
loading the weights
Model: "actor_network"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
actor_input_state (InputLaye [(None, 7, 2)]            0         
_________________________________________________________________
conv1d (Conv1D)              (None, 6, 16)             80        
_________________________________________________________________
actor_rnn (GRU)              (None, 10)                840       
_________________________________________________________________
actor_dense_1 (Dense)        (None, 50)                550       
_________________________________________________________________
batch_normalization (BatchNo (None, 50)                200       
_________________________________________________________________
activation (Activation)      (None, 50)                0         
_________________________________________________________________
actor_dense_2 (Dense)        (None, 40)                2040      
_________________________________________________________________
batch_normalization_1 (Batch (None, 40)                160       
_________________________________________________________________
activation_1 (Activation)    (None, 40)                0         
_________________________________________________________________
actor_dense_3 (Dense)        (None, 1)                 41        
_________________________________________________________________
tf_op_layer_actions_scaling  [(None, 1)]               0         
=================================================================
Total params: 3,911
Trainable params: 3,731
Non-trainable params: 180
_________________________________________________________________
None
Model: "critic_network"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
critic_input_state (InputLayer) [(None, 7, 2)]       0                                            
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, 6, 16)        80          critic_input_state[0][0]         
__________________________________________________________________________________________________
gru (GRU)                       (None, 10)           840         conv1d_2[0][0]                   
__________________________________________________________________________________________________
critic_dense_1 (Dense)          (None, 50)           550         gru[0][0]                        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 50)           200         critic_dense_1[0][0]             
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 50)           0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
critic_input_action (InputLayer [(None, 1)]          0                                            
__________________________________________________________________________________________________
critic_dense_2_state (Dense)    (None, 20)           1020        activation_4[0][0]               
__________________________________________________________________________________________________
critic_dense_2_action (Dense)   (None, 20)           40          critic_input_action[0][0]        
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 40)           0           critic_dense_2_state[0][0]       
                                                                 critic_dense_2_action[0][0]      
__________________________________________________________________________________________________
critic_dense_3_state (Dense)    (None, 20)           820         concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 20)           80          critic_dense_3_state[0][0]       
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 20)           0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
Q_val (Dense)                   (None, 1)            21          activation_5[0][0]               
==================================================================================================
Total params: 3,651
Trainable params: 3,511
Non-trainable params: 140
__________________________________________________________________________________________________
None
starting the simulation
running - train_rnn_cbf
| Reward: 10065.4449 | Episode: 0 | Qmax: 9.4766
| Reward: 9850.1886 | Episode: 1 | Qmax: 19.5273
| Reward: 9849.7222 | Episode: 2 | Qmax: 31.9437
| Reward: 9850.0857 | Episode: 3 | Qmax: 46.7878
| Reward: 9849.9196 | Episode: 4 | Qmax: 61.6585
| Reward: 10621.4623 | Episode: 5 | Qmax: 76.3438
| Reward: 11242.4805 | Episode: 6 | Qmax: 92.1110
| Reward: 11242.3304 | Episode: 7 | Qmax: 109.0134
| Reward: 11241.8193 | Episode: 8 | Qmax: 125.9624
| Reward: 11242.6663 | Episode: 9 | Qmax: 142.1154
| Reward: 11242.3854 | Episode: 10 | Qmax: 157.3040
| Reward: 11242.4242 | Episode: 11 | Qmax: 171.4030
| Reward: 11242.6165 | Episode: 12 | Qmax: 184.6412
| Reward: 11242.4940 | Episode: 13 | Qmax: 196.8100
| Reward: 11242.1667 | Episode: 14 | Qmax: 207.8668
| Reward: 11242.1494 | Episode: 15 | Qmax: 218.3078
| Reward: 11242.3475 | Episode: 16 | Qmax: 229.3528
| Reward: 11242.3748 | Episode: 17 | Qmax: 240.1472
| Reward: 11242.1098 | Episode: 18 | Qmax: 251.0113
| Reward: 11242.0789 | Episode: 19 | Qmax: 261.1643
| Reward: 11242.3223 | Episode: 20 | Qmax: 270.4580
| Reward: 11242.5281 | Episode: 21 | Qmax: 280.0544
| Reward: 11242.2638 | Episode: 22 | Qmax: 289.6425
| Reward: 11242.2082 | Episode: 23 | Qmax: 299.1533
| Reward: 11242.5085 | Episode: 24 | Qmax: 308.6132
| Reward: 11242.1462 | Episode: 25 | Qmax: 317.9751
| Reward: 11242.0710 | Episode: 26 | Qmax: 327.2108
| Reward: 11242.3362 | Episode: 27 | Qmax: 336.4449
| Reward: 11242.5396 | Episode: 28 | Qmax: 346.2589
| Reward: 11242.2621 | Episode: 29 | Qmax: 356.3040
| Reward: 11242.1192 | Episode: 30 | Qmax: 366.2414
| Reward: 11242.3656 | Episode: 31 | Qmax: 376.1931
| Reward: 11242.5680 | Episode: 32 | Qmax: 386.3921
| Reward: 11242.4781 | Episode: 33 | Qmax: 396.9425
| Reward: 11242.3326 | Episode: 34 | Qmax: 407.1575
| Reward: 11242.6421 | Episode: 35 | Qmax: 417.1721
| Reward: 11242.2999 | Episode: 36 | Qmax: 427.2522
| Reward: 11242.3591 | Episode: 37 | Qmax: 436.9737
| Reward: 11242.2441 | Episode: 38 | Qmax: 446.2908
| Reward: 11242.5407 | Episode: 39 | Qmax: 456.1232
| Reward: 11242.5549 | Episode: 40 | Qmax: 465.4510
| Reward: 11242.1926 | Episode: 41 | Qmax: 475.1013
| Reward: 11242.4813 | Episode: 42 | Qmax: 484.5163
| Reward: 11242.4031 | Episode: 43 | Qmax: 493.6653
| Reward: 11242.6629 | Episode: 44 | Qmax: 502.5026
| Reward: 11242.3382 | Episode: 45 | Qmax: 511.5520
| Reward: 11242.7525 | Episode: 46 | Qmax: 520.3725
| Reward: 11242.1089 | Episode: 47 | Qmax: 529.3222
| Reward: 11242.9973 | Episode: 48 | Qmax: 539.4145
| Reward: 11242.7078 | Episode: 49 | Qmax: 550.1087
| Reward: 11242.0149 | Episode: 50 | Qmax: 559.9461
| Reward: 11242.1797 | Episode: 51 | Qmax: 569.7826
| Reward: 11243.1015 | Episode: 52 | Qmax: 579.1979
| Reward: 11242.2779 | Episode: 53 | Qmax: 588.6052
| Reward: 11242.5396 | Episode: 54 | Qmax: 597.6163
| Reward: 11242.4657 | Episode: 55 | Qmax: 607.0406
| Reward: 11242.7090 | Episode: 56 | Qmax: 616.2333
| Reward: 11242.6763 | Episode: 57 | Qmax: 624.9967
| Reward: 11242.1714 | Episode: 58 | Qmax: 633.6990
| Reward: 11242.4861 | Episode: 59 | Qmax: 642.2642
| Reward: 11242.2028 | Episode: 60 | Qmax: 649.5047
| Reward: 11242.5644 | Episode: 61 | Qmax: 657.4895
| Reward: 11241.9920 | Episode: 62 | Qmax: 665.0856
| Reward: 11241.8037 | Episode: 63 | Qmax: 672.3099
| Reward: 11242.2365 | Episode: 64 | Qmax: 679.4115
| Reward: 11242.3250 | Episode: 65 | Qmax: 686.5538
| Reward: 11242.6061 | Episode: 66 | Qmax: 693.1029
| Reward: 11242.7661 | Episode: 67 | Qmax: 699.8207
| Reward: 11242.1049 | Episode: 68 | Qmax: 706.0261
| Reward: 11243.0016 | Episode: 69 | Qmax: 711.4251
| Reward: 11242.0148 | Episode: 70 | Qmax: 717.4982
| Reward: 11242.6578 | Episode: 71 | Qmax: 723.0936
| Reward: 11242.7518 | Episode: 72 | Qmax: 729.1721
| Reward: 11242.1344 | Episode: 73 | Qmax: 734.8461
| Reward: 11242.4647 | Episode: 74 | Qmax: 739.4145
| Reward: 11242.1130 | Episode: 75 | Qmax: 744.9268
| Reward: 11242.5156 | Episode: 76 | Qmax: 750.5695
| Reward: 11242.1767 | Episode: 77 | Qmax: 756.1202
| Reward: 11242.3674 | Episode: 78 | Qmax: 763.4555
| Reward: 11241.9856 | Episode: 79 | Qmax: 771.2491
| Reward: 11242.3871 | Episode: 80 | Qmax: 779.4512
| Reward: 11242.0680 | Episode: 81 | Qmax: 788.5434
| Reward: 11242.4709 | Episode: 82 | Qmax: 797.4568
| Reward: 11241.9223 | Episode: 83 | Qmax: 806.2913
| Reward: 11242.6374 | Episode: 84 | Qmax: 814.5614
| Reward: 11242.1324 | Episode: 85 | Qmax: 822.1460
| Reward: 11242.8317 | Episode: 86 | Qmax: 829.7724
| Reward: 11242.0006 | Episode: 87 | Qmax: 836.0186
| Reward: 11241.9136 | Episode: 88 | Qmax: 842.3835
| Reward: 11242.0941 | Episode: 89 | Qmax: 848.0475
| Reward: 11243.1195 | Episode: 90 | Qmax: 853.1225
| Reward: 11242.3265 | Episode: 91 | Qmax: 857.5472
| Reward: 11242.4485 | Episode: 92 | Qmax: 860.4069
| Reward: 11242.5098 | Episode: 93 | Qmax: 863.6107
| Reward: 11242.8151 | Episode: 94 | Qmax: 866.3004
| Reward: 11242.2853 | Episode: 95 | Qmax: 868.1632
| Reward: 11242.1698 | Episode: 96 | Qmax: 869.7423
| Reward: 11242.3891 | Episode: 97 | Qmax: 870.4625
| Reward: 11242.5978 | Episode: 98 | Qmax: 872.2336
| Reward: 11241.8019 | Episode: 99 | Qmax: 873.6322
| Reward: 11241.7040 | Episode: 100 | Qmax: 873.1768
| Reward: 11242.4890 | Episode: 101 | Qmax: 873.0580
| Reward: 11241.8422 | Episode: 102 | Qmax: 873.0628
| Reward: 11242.2027 | Episode: 103 | Qmax: 873.2287
| Reward: 11242.3581 | Episode: 104 | Qmax: 873.4961
| Reward: 11242.5788 | Episode: 105 | Qmax: 874.3843
| Reward: 11242.5254 | Episode: 106 | Qmax: 874.4131
| Reward: 11243.0100 | Episode: 107 | Qmax: 875.3781
| Reward: 11242.3518 | Episode: 108 | Qmax: 874.9550
| Reward: 11241.7445 | Episode: 109 | Qmax: 875.5771
| Reward: 11242.4922 | Episode: 110 | Qmax: 876.7789
| Reward: 11242.6736 | Episode: 111 | Qmax: 878.4428
| Reward: 11241.8983 | Episode: 112 | Qmax: 880.1869
| Reward: 11242.7393 | Episode: 113 | Qmax: 882.0181
| Reward: 11242.9955 | Episode: 114 | Qmax: 884.2297
| Reward: 11242.6295 | Episode: 115 | Qmax: 886.7158
| Reward: 11241.9010 | Episode: 116 | Qmax: 888.8671
| Reward: 11242.3212 | Episode: 117 | Qmax: 889.5621
| Reward: 11242.0591 | Episode: 118 | Qmax: 891.2121
| Reward: 11242.4644 | Episode: 119 | Qmax: 892.4767
| Reward: 11242.3356 | Episode: 120 | Qmax: 891.7029
| Reward: 11242.7432 | Episode: 121 | Qmax: 893.2095
| Reward: 11242.1127 | Episode: 122 | Qmax: 894.7140
| Reward: 11242.9517 | Episode: 123 | Qmax: 891.6927
| Reward: 11242.1268 | Episode: 124 | Qmax: 889.5219
| Reward: 11243.1166 | Episode: 125 | Qmax: 879.8476
| Reward: 11242.3061 | Episode: 126 | Qmax: 871.3054
| Reward: 11242.9805 | Episode: 127 | Qmax: 866.2149
| Reward: 11242.2426 | Episode: 128 | Qmax: 874.0766
| Reward: 11242.2370 | Episode: 129 | Qmax: 883.5234
| Reward: 11242.5235 | Episode: 130 | Qmax: 900.4166
| Reward: 11242.5235 | Episode: 131 | Qmax: 922.5500
| Reward: 11242.3688 | Episode: 132 | Qmax: 942.6622
| Reward: 11242.4639 | Episode: 133 | Qmax: 947.6941
| Reward: 11242.5593 | Episode: 134 | Qmax: 946.3632
| Reward: 11242.4412 | Episode: 135 | Qmax: 942.8309
| Reward: 11242.3573 | Episode: 136 | Qmax: 937.5660
| Reward: 11242.1007 | Episode: 137 | Qmax: 931.9265
| Reward: 11242.1155 | Episode: 138 | Qmax: 923.5265
| Reward: 11241.9691 | Episode: 139 | Qmax: 917.3219
| Reward: 11243.0161 | Episode: 140 | Qmax: 913.0674
| Reward: 11242.8232 | Episode: 141 | Qmax: 912.0176
| Reward: 11241.8036 | Episode: 142 | Qmax: 911.6929
| Reward: 11242.5143 | Episode: 143 | Qmax: 911.4982
| Reward: 11242.7183 | Episode: 144 | Qmax: 912.2197
| Reward: 11242.5503 | Episode: 145 | Qmax: 914.5120
| Reward: 11242.0178 | Episode: 146 | Qmax: 918.3418
| Reward: 11242.9944 | Episode: 147 | Qmax: 924.3857
| Reward: 11242.1362 | Episode: 148 | Qmax: 932.0388
| Reward: 11242.4205 | Episode: 149 | Qmax: 939.7729
| Reward: 11242.0822 | Episode: 150 | Qmax: 948.0046
| Reward: 11242.4697 | Episode: 151 | Qmax: 956.3760
| Reward: 11242.3420 | Episode: 152 | Qmax: 964.5242
| Reward: 11242.1164 | Episode: 153 | Qmax: 971.4511
| Reward: 11242.7516 | Episode: 154 | Qmax: 977.7834
| Reward: 11242.1395 | Episode: 155 | Qmax: 983.6139
| Reward: 11242.1905 | Episode: 156 | Qmax: 990.7472
| Reward: 11242.4606 | Episode: 157 | Qmax: 997.1815
| Reward: 11241.8379 | Episode: 158 | Qmax: 1003.5882
| Reward: 11242.2102 | Episode: 159 | Qmax: 1010.8377
| Reward: 11242.7190 | Episode: 160 | Qmax: 1018.7809
| Reward: 11242.2145 | Episode: 161 | Qmax: 1027.8738
| Reward: 11242.6098 | Episode: 162 | Qmax: 1035.8080
| Reward: 11242.2841 | Episode: 163 | Qmax: 1045.2898
| Reward: 11242.7197 | Episode: 164 | Qmax: 1054.8828
| Reward: 11242.6289 | Episode: 165 | Qmax: 1063.4455
| Reward: 11242.7076 | Episode: 166 | Qmax: 1071.1141
| Reward: 11242.3927 | Episode: 167 | Qmax: 1078.2970
| Reward: 11241.5960 | Episode: 168 | Qmax: 1084.3112
| Reward: 11241.9872 | Episode: 169 | Qmax: 1089.5390
| Reward: 11242.1380 | Episode: 170 | Qmax: 1095.8991
| Reward: 11242.4819 | Episode: 171 | Qmax: 1102.4634
| Reward: 11242.1966 | Episode: 172 | Qmax: 1110.6267
| Reward: 11242.2678 | Episode: 173 | Qmax: 1118.3416
| Reward: 11242.4585 | Episode: 174 | Qmax: 1126.5116
| Reward: 11242.6884 | Episode: 175 | Qmax: 1132.6156
| Reward: 11242.3940 | Episode: 176 | Qmax: 1138.5370
| Reward: 11242.2970 | Episode: 177 | Qmax: 1139.7049
| Reward: 11242.8865 | Episode: 178 | Qmax: 1139.3319
| Reward: 11242.5752 | Episode: 179 | Qmax: 1139.7173
| Reward: 11242.9431 | Episode: 180 | Qmax: 1140.8911
| Reward: 11242.1397 | Episode: 181 | Qmax: 1140.2784
| Reward: 11242.6123 | Episode: 182 | Qmax: 1144.5250
| Reward: 11242.0152 | Episode: 183 | Qmax: 1147.0862
| Reward: 11242.0324 | Episode: 184 | Qmax: 1151.2427
| Reward: 11242.0004 | Episode: 185 | Qmax: 1155.8044
| Reward: 11242.7408 | Episode: 186 | Qmax: 1161.6411
| Reward: 11242.8576 | Episode: 187 | Qmax: 1167.9646
| Reward: 11242.1527 | Episode: 188 | Qmax: 1174.4492
| Reward: 11242.4581 | Episode: 189 | Qmax: 1180.7384
| Reward: 11242.9344 | Episode: 190 | Qmax: 1187.2534
| Reward: 11242.6677 | Episode: 191 | Qmax: 1193.6806
| Reward: 11242.4929 | Episode: 192 | Qmax: 1200.9683
| Reward: 11242.1190 | Episode: 193 | Qmax: 1207.3612
| Reward: 11242.2791 | Episode: 194 | Qmax: 1214.9084
| Reward: 11242.7927 | Episode: 195 | Qmax: 1222.1503
| Reward: 11242.4524 | Episode: 196 | Qmax: 1229.4064
| Reward: 11242.5657 | Episode: 197 | Qmax: 1236.6634
| Reward: 11242.6492 | Episode: 198 | Qmax: 1243.7609
| Reward: 11242.3526 | Episode: 199 | Qmax: 1248.5438
saving weights
Plotting an new testing environment
