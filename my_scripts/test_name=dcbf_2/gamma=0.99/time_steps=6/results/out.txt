summary_dir /afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=6
use_gpu True
save_model True
load_model False
random_seed 1754
buffer_size 1000000
max_episodes 200
max_episode_len 1464
mini_batch_size 300
actor_lr 0.0001
critic_lr 0.001
gamma 0.99
noise_var 0.0925
scaling True
state_dim 2
action_dim 1
action_bound [1.]
discretization_time 0.001
T_set_max_min [23.0, 26.0]
T_max_min [22.0, 25.0]
time_steps 6
actor_rnn 10
actor_l1 50
actor_l2 40
critic_rnn 10
critic_l1 50
critic_l2 20
tau 0.001
{'T_max_min': [22.0, 25.0],
 'T_set_max_min': [23.0, 26.0],
 'action_bound': array([1.], dtype=float32),
 'action_dim': 1,
 'actor_l1': 50,
 'actor_l2': 40,
 'actor_lr': 0.0001,
 'actor_rnn': 10,
 'buffer_size': 1000000,
 'critic_l1': 50,
 'critic_l2': 20,
 'critic_lr': 0.001,
 'critic_rnn': 10,
 'discretization_time': 0.001,
 'gamma': 0.99,
 'load_model': False,
 'max_episode_len': 1464,
 'max_episodes': 200,
 'mini_batch_size': 300,
 'noise_var': 0.0925,
 'random_seed': 1754,
 'save_model': True,
 'scaling': True,
 'state_dim': 2,
 'summary_dir': '/afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=6',
 'tau': 0.001,
 'time_steps': 6,
 'use_gpu': True}
starting the scaling
finished the scaling
[0.48696854 0.02814456] [ 23.99765757 -28.57378731]
initalizing the actor and critic func
loading the weights
Model: "actor_network"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
actor_input_state (InputLaye [(None, 6, 2)]            0         
_________________________________________________________________
conv1d (Conv1D)              (None, 5, 16)             80        
_________________________________________________________________
actor_rnn (GRU)              (None, 10)                840       
_________________________________________________________________
actor_dense_1 (Dense)        (None, 50)                550       
_________________________________________________________________
batch_normalization (BatchNo (None, 50)                200       
_________________________________________________________________
activation (Activation)      (None, 50)                0         
_________________________________________________________________
actor_dense_2 (Dense)        (None, 40)                2040      
_________________________________________________________________
batch_normalization_1 (Batch (None, 40)                160       
_________________________________________________________________
activation_1 (Activation)    (None, 40)                0         
_________________________________________________________________
actor_dense_3 (Dense)        (None, 1)                 41        
_________________________________________________________________
tf_op_layer_actions_scaling  [(None, 1)]               0         
=================================================================
Total params: 3,911
Trainable params: 3,731
Non-trainable params: 180
_________________________________________________________________
None
Model: "critic_network"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
critic_input_state (InputLayer) [(None, 6, 2)]       0                                            
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, 5, 16)        80          critic_input_state[0][0]         
__________________________________________________________________________________________________
gru (GRU)                       (None, 10)           840         conv1d_2[0][0]                   
__________________________________________________________________________________________________
critic_dense_1 (Dense)          (None, 50)           550         gru[0][0]                        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 50)           200         critic_dense_1[0][0]             
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 50)           0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
critic_input_action (InputLayer [(None, 1)]          0                                            
__________________________________________________________________________________________________
critic_dense_2_state (Dense)    (None, 20)           1020        activation_4[0][0]               
__________________________________________________________________________________________________
critic_dense_2_action (Dense)   (None, 20)           40          critic_input_action[0][0]        
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 40)           0           critic_dense_2_state[0][0]       
                                                                 critic_dense_2_action[0][0]      
__________________________________________________________________________________________________
critic_dense_3_state (Dense)    (None, 20)           820         concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 20)           80          critic_dense_3_state[0][0]       
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 20)           0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
Q_val (Dense)                   (None, 1)            21          activation_5[0][0]               
==================================================================================================
Total params: 3,651
Trainable params: 3,511
Non-trainable params: 140
__________________________________________________________________________________________________
None
starting the simulation
running - train_rnn_cbf
| Reward: 10062.0397 | Episode: 0 | Qmax: 9.6489
| Reward: 9852.2136 | Episode: 1 | Qmax: 19.8618
| Reward: 9851.8073 | Episode: 2 | Qmax: 31.5684
| Reward: 9851.8265 | Episode: 3 | Qmax: 45.9937
| Reward: 10696.1651 | Episode: 4 | Qmax: 62.3255
| Reward: 11244.5984 | Episode: 5 | Qmax: 83.2305
| Reward: 11245.4751 | Episode: 6 | Qmax: 108.0375
| Reward: 11245.0582 | Episode: 7 | Qmax: 132.1986
| Reward: 11245.1371 | Episode: 8 | Qmax: 154.8759
| Reward: 11245.5179 | Episode: 9 | Qmax: 175.7328
| Reward: 11244.7995 | Episode: 10 | Qmax: 194.4243
| Reward: 11245.1576 | Episode: 11 | Qmax: 211.0887
| Reward: 11244.9722 | Episode: 12 | Qmax: 225.5330
| Reward: 11245.5852 | Episode: 13 | Qmax: 237.2926
| Reward: 11244.7887 | Episode: 14 | Qmax: 246.7337
| Reward: 11245.8296 | Episode: 15 | Qmax: 255.2232
| Reward: 11245.3026 | Episode: 16 | Qmax: 263.1537
| Reward: 11245.2265 | Episode: 17 | Qmax: 270.5767
| Reward: 11245.3524 | Episode: 18 | Qmax: 278.1196
| Reward: 11245.2410 | Episode: 19 | Qmax: 285.9800
| Reward: 11246.0995 | Episode: 20 | Qmax: 294.3529
| Reward: 11245.3879 | Episode: 21 | Qmax: 302.9707
| Reward: 11245.8487 | Episode: 22 | Qmax: 311.7644
| Reward: 11245.5354 | Episode: 23 | Qmax: 320.3640
| Reward: 11245.3996 | Episode: 24 | Qmax: 328.6319
| Reward: 11245.2274 | Episode: 25 | Qmax: 336.4016
| Reward: 11245.5897 | Episode: 26 | Qmax: 343.5138
| Reward: 11245.8754 | Episode: 27 | Qmax: 350.1539
| Reward: 11245.3362 | Episode: 28 | Qmax: 356.4752
| Reward: 11244.9911 | Episode: 29 | Qmax: 362.1330
| Reward: 11245.8370 | Episode: 30 | Qmax: 367.6414
| Reward: 11245.3986 | Episode: 31 | Qmax: 372.7728
| Reward: 11245.0398 | Episode: 32 | Qmax: 377.8675
| Reward: 11245.3231 | Episode: 33 | Qmax: 383.1427
| Reward: 11245.7020 | Episode: 34 | Qmax: 389.2316
| Reward: 11244.8124 | Episode: 35 | Qmax: 395.2928
| Reward: 11245.5766 | Episode: 36 | Qmax: 400.6190
| Reward: 11245.5329 | Episode: 37 | Qmax: 407.0176
| Reward: 11245.3914 | Episode: 38 | Qmax: 413.5656
| Reward: 11245.3310 | Episode: 39 | Qmax: 420.2204
| Reward: 11245.4592 | Episode: 40 | Qmax: 426.1882
| Reward: 11245.1873 | Episode: 41 | Qmax: 432.7372
| Reward: 11245.7811 | Episode: 42 | Qmax: 438.7058
| Reward: 11245.6420 | Episode: 43 | Qmax: 445.2370
| Reward: 11244.7695 | Episode: 44 | Qmax: 449.3382
| Reward: 11245.9101 | Episode: 45 | Qmax: 453.1868
| Reward: 11245.1833 | Episode: 46 | Qmax: 458.3949
| Reward: 11245.3066 | Episode: 47 | Qmax: 467.5981
| Reward: 11245.4661 | Episode: 48 | Qmax: 475.9573
| Reward: 11245.1561 | Episode: 49 | Qmax: 478.3300
| Reward: 11245.2250 | Episode: 50 | Qmax: 483.5145
| Reward: 11244.7438 | Episode: 51 | Qmax: 488.0503
| Reward: 11245.0282 | Episode: 52 | Qmax: 492.0731
| Reward: 11244.9160 | Episode: 53 | Qmax: 496.6706
| Reward: 11245.9112 | Episode: 54 | Qmax: 503.0436
| Reward: 11245.8413 | Episode: 55 | Qmax: 508.6624
| Reward: 11245.5895 | Episode: 56 | Qmax: 512.3385
| Reward: 11245.3729 | Episode: 57 | Qmax: 518.0443
| Reward: 11245.3942 | Episode: 58 | Qmax: 523.1825
| Reward: 11244.9047 | Episode: 59 | Qmax: 536.8835
| Reward: 11245.6986 | Episode: 60 | Qmax: 545.3456
| Reward: 11245.9138 | Episode: 61 | Qmax: 547.1406
| Reward: 11245.2789 | Episode: 62 | Qmax: 549.8045
| Reward: 11245.5277 | Episode: 63 | Qmax: 561.4543
| Reward: 11244.8048 | Episode: 64 | Qmax: 579.4990
| Reward: 11245.0640 | Episode: 65 | Qmax: 598.4578
| Reward: 11245.3260 | Episode: 66 | Qmax: 622.5466
| Reward: 11245.5488 | Episode: 67 | Qmax: 654.2505
| Reward: 11245.0154 | Episode: 68 | Qmax: 691.7906
| Reward: 11245.0427 | Episode: 69 | Qmax: 726.1738
| Reward: 11244.9482 | Episode: 70 | Qmax: 755.7761
| Reward: 11245.4987 | Episode: 71 | Qmax: 781.4887
| Reward: 11245.2973 | Episode: 72 | Qmax: 805.0976
| Reward: 11245.8459 | Episode: 73 | Qmax: 823.4510
| Reward: 11245.2469 | Episode: 74 | Qmax: 854.3064
| Reward: 11244.8603 | Episode: 75 | Qmax: 903.4286
| Reward: 11245.1469 | Episode: 76 | Qmax: 917.2766
| Reward: 11245.6834 | Episode: 77 | Qmax: 938.8521
| Reward: 11245.3397 | Episode: 78 | Qmax: 963.5574
| Reward: 11245.2876 | Episode: 79 | Qmax: 991.8159
| Reward: 11245.6137 | Episode: 80 | Qmax: 1025.7768
| Reward: 11245.6847 | Episode: 81 | Qmax: 1059.3981
| Reward: 11244.7562 | Episode: 82 | Qmax: 1094.5336
| Reward: 11245.6729 | Episode: 83 | Qmax: 1139.8693
| Reward: 11245.4767 | Episode: 84 | Qmax: 1168.2145
| Reward: 11244.8068 | Episode: 85 | Qmax: 1198.4337
| Reward: 11245.3451 | Episode: 86 | Qmax: 1230.0980
| Reward: 11245.0473 | Episode: 87 | Qmax: 1267.8994
| Reward: 11245.2523 | Episode: 88 | Qmax: 1300.7539
| Reward: 11245.4463 | Episode: 89 | Qmax: 1346.4570
| Reward: 11244.9170 | Episode: 90 | Qmax: 1364.1260
| Reward: 11245.0654 | Episode: 91 | Qmax: 1380.4798
| Reward: 11245.3560 | Episode: 92 | Qmax: 1397.8573
| Reward: 11245.3067 | Episode: 93 | Qmax: 1426.2992
| Reward: 11245.4853 | Episode: 94 | Qmax: 1452.3944
| Reward: 11245.8415 | Episode: 95 | Qmax: 1475.7471
| Reward: 11245.4355 | Episode: 96 | Qmax: 1500.0533
| Reward: 11245.3975 | Episode: 97 | Qmax: 1519.9531
| Reward: 11245.5300 | Episode: 98 | Qmax: 1545.9709
| Reward: 11244.9091 | Episode: 99 | Qmax: 1577.7557
| Reward: 11245.1793 | Episode: 100 | Qmax: 1592.4053
| Reward: 11245.1345 | Episode: 101 | Qmax: 1610.7560
| Reward: 11245.1346 | Episode: 102 | Qmax: 1637.4986
| Reward: 11245.4091 | Episode: 103 | Qmax: 1654.3977
| Reward: 11245.3368 | Episode: 104 | Qmax: 1665.8537
| Reward: 11244.9138 | Episode: 105 | Qmax: 1699.4581
| Reward: 11245.6627 | Episode: 106 | Qmax: 1702.5219
| Reward: 11245.0138 | Episode: 107 | Qmax: 1730.8920
| Reward: 11244.9151 | Episode: 108 | Qmax: 1764.3490
| Reward: 11245.5500 | Episode: 109 | Qmax: 1780.8679
| Reward: 11244.6647 | Episode: 110 | Qmax: 1814.9793
| Reward: 11245.5401 | Episode: 111 | Qmax: 1869.2003
| Reward: 11245.5913 | Episode: 112 | Qmax: 1912.9815
| Reward: 11245.6680 | Episode: 113 | Qmax: 1964.6574
| Reward: 11246.0287 | Episode: 114 | Qmax: 1990.7820
| Reward: 11245.4448 | Episode: 115 | Qmax: 2022.5661
| Reward: 11245.2282 | Episode: 116 | Qmax: 2059.6424
| Reward: 11245.3631 | Episode: 117 | Qmax: 2110.2044
| Reward: 11245.6617 | Episode: 118 | Qmax: 2135.4001
| Reward: 11245.4586 | Episode: 119 | Qmax: 2165.5033
| Reward: 11245.7564 | Episode: 120 | Qmax: 2199.7009
| Reward: 11245.4036 | Episode: 121 | Qmax: 2262.9996
| Reward: 11245.8086 | Episode: 122 | Qmax: 2290.6924
| Reward: 11245.8923 | Episode: 123 | Qmax: 2344.8515
| Reward: 11245.4962 | Episode: 124 | Qmax: 2397.5236
| Reward: 11245.2220 | Episode: 125 | Qmax: 2445.8639
| Reward: 11244.8459 | Episode: 126 | Qmax: 2505.0971
| Reward: 11245.3758 | Episode: 127 | Qmax: 2568.7323
| Reward: 11245.1093 | Episode: 128 | Qmax: 2634.9190
| Reward: 11245.9246 | Episode: 129 | Qmax: 2713.7013
| Reward: 11245.3221 | Episode: 130 | Qmax: 2805.9458
| Reward: 11245.4741 | Episode: 131 | Qmax: 2892.7190
| Reward: 11244.8460 | Episode: 132 | Qmax: 2968.5914
| Reward: 11244.5574 | Episode: 133 | Qmax: 3039.7088
| Reward: 11245.4817 | Episode: 134 | Qmax: 3098.5251
| Reward: 11245.1041 | Episode: 135 | Qmax: 3126.4610
| Reward: 11245.5462 | Episode: 136 | Qmax: 3157.4982
| Reward: 11245.4092 | Episode: 137 | Qmax: 3165.1160
| Reward: 11245.6978 | Episode: 138 | Qmax: 3184.1049
| Reward: 11245.1919 | Episode: 139 | Qmax: 3223.8282
| Reward: 11245.3576 | Episode: 140 | Qmax: 3272.6196
| Reward: 11245.2992 | Episode: 141 | Qmax: 3345.0756
| Reward: 11245.1947 | Episode: 142 | Qmax: 3391.3534
| Reward: 11245.0644 | Episode: 143 | Qmax: 3440.0764
| Reward: 11245.6051 | Episode: 144 | Qmax: 3490.6082
| Reward: 11245.6305 | Episode: 145 | Qmax: 3542.7347
| Reward: 11244.7811 | Episode: 146 | Qmax: 3594.9971
| Reward: 11245.4681 | Episode: 147 | Qmax: 3637.4258
| Reward: 11245.8108 | Episode: 148 | Qmax: 3726.4864
| Reward: 11244.8495 | Episode: 149 | Qmax: 3811.4382
| Reward: 11245.4458 | Episode: 150 | Qmax: 3922.8987
| Reward: 11245.2106 | Episode: 151 | Qmax: 4038.7979
| Reward: 11245.6274 | Episode: 152 | Qmax: 4144.0127
| Reward: 11245.2645 | Episode: 153 | Qmax: 4257.0685
| Reward: 11245.7128 | Episode: 154 | Qmax: 4353.9639
| Reward: 11245.2185 | Episode: 155 | Qmax: 4456.2985
| Reward: 11245.3765 | Episode: 156 | Qmax: 4540.6995
| Reward: 11245.2192 | Episode: 157 | Qmax: 4626.5597
| Reward: 11245.6947 | Episode: 158 | Qmax: 4730.6747
| Reward: 11245.2075 | Episode: 159 | Qmax: 4820.0932
| Reward: 11244.9375 | Episode: 160 | Qmax: 4901.9702
| Reward: 11245.2498 | Episode: 161 | Qmax: 4978.1798
| Reward: 11245.4539 | Episode: 162 | Qmax: 5076.3755
| Reward: 11245.5532 | Episode: 163 | Qmax: 5112.3615
| Reward: 11245.1267 | Episode: 164 | Qmax: 5176.2457
| Reward: 11244.8805 | Episode: 165 | Qmax: 5190.0049
| Reward: 11244.8588 | Episode: 166 | Qmax: 5255.0603
| Reward: 11245.0841 | Episode: 167 | Qmax: 5298.7586
| Reward: 11245.2540 | Episode: 168 | Qmax: 5293.9221
| Reward: 11245.5606 | Episode: 169 | Qmax: 5325.9269
| Reward: 11245.1839 | Episode: 170 | Qmax: 5322.3556
| Reward: 11245.2225 | Episode: 171 | Qmax: 5300.1431
| Reward: 11245.9093 | Episode: 172 | Qmax: 5322.3409
| Reward: 11244.9935 | Episode: 173 | Qmax: 5308.0111
| Reward: 11245.0534 | Episode: 174 | Qmax: 5290.9361
| Reward: 11245.4377 | Episode: 175 | Qmax: 5326.4241
| Reward: 11245.3003 | Episode: 176 | Qmax: 5323.9651
| Reward: 11245.6599 | Episode: 177 | Qmax: 5360.8513
| Reward: 11245.6526 | Episode: 178 | Qmax: 5334.9570
| Reward: 11245.6504 | Episode: 179 | Qmax: 5376.2581
| Reward: 11244.8427 | Episode: 180 | Qmax: 5360.1309
| Reward: 11245.8373 | Episode: 181 | Qmax: 5415.9893
| Reward: 11245.2959 | Episode: 182 | Qmax: 5380.6424
| Reward: 11244.8695 | Episode: 183 | Qmax: 5360.8354
| Reward: 11244.8598 | Episode: 184 | Qmax: 5364.1027
| Reward: 11245.9108 | Episode: 185 | Qmax: 5385.7919
| Reward: 11245.7482 | Episode: 186 | Qmax: 5372.9053
| Reward: 11244.6360 | Episode: 187 | Qmax: 5421.4138
| Reward: 11245.2617 | Episode: 188 | Qmax: 5411.3827
| Reward: 11245.2471 | Episode: 189 | Qmax: 5424.2796
| Reward: 11245.3170 | Episode: 190 | Qmax: 5461.0128
| Reward: 11245.2055 | Episode: 191 | Qmax: 5507.9109
| Reward: 11244.7739 | Episode: 192 | Qmax: 5582.1009
| Reward: 11245.5440 | Episode: 193 | Qmax: 5696.7824
| Reward: 11245.3161 | Episode: 194 | Qmax: 5933.7035
| Reward: 11245.7271 | Episode: 195 | Qmax: 6170.9675
| Reward: 11245.5597 | Episode: 196 | Qmax: 6407.0481
| Reward: 11244.8131 | Episode: 197 | Qmax: 6674.3962
| Reward: 11245.9132 | Episode: 198 | Qmax: 6966.4837
| Reward: 11244.8732 | Episode: 199 | Qmax: 7295.8047
saving weights
Plotting an new testing environment
