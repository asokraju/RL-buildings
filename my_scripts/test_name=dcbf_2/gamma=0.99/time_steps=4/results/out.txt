summary_dir /afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=4
use_gpu True
save_model True
load_model False
random_seed 1754
buffer_size 1000000
max_episodes 200
max_episode_len 1464
mini_batch_size 300
actor_lr 0.0001
critic_lr 0.001
gamma 0.99
noise_var 0.0925
scaling True
state_dim 2
action_dim 1
action_bound [1.]
discretization_time 0.001
T_set_max_min [23.0, 26.0]
T_max_min [22.0, 25.0]
time_steps 4
actor_rnn 10
actor_l1 50
actor_l2 40
critic_rnn 10
critic_l1 50
critic_l2 20
tau 0.001
{'T_max_min': [22.0, 25.0],
 'T_set_max_min': [23.0, 26.0],
 'action_bound': array([1.], dtype=float32),
 'action_dim': 1,
 'actor_l1': 50,
 'actor_l2': 40,
 'actor_lr': 0.0001,
 'actor_rnn': 10,
 'buffer_size': 1000000,
 'critic_l1': 50,
 'critic_l2': 20,
 'critic_lr': 0.001,
 'critic_rnn': 10,
 'discretization_time': 0.001,
 'gamma': 0.99,
 'load_model': False,
 'max_episode_len': 1464,
 'max_episodes': 200,
 'mini_batch_size': 300,
 'noise_var': 0.0925,
 'random_seed': 1754,
 'save_model': True,
 'scaling': True,
 'state_dim': 2,
 'summary_dir': '/afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=4',
 'tau': 0.001,
 'time_steps': 4,
 'use_gpu': True}
starting the scaling
finished the scaling
[0.47711214 0.02821709] [ 23.99340407 -28.58059799]
initalizing the actor and critic func
loading the weights
Model: "actor_network"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
actor_input_state (InputLaye [(None, 4, 2)]            0         
_________________________________________________________________
conv1d (Conv1D)              (None, 3, 16)             80        
_________________________________________________________________
actor_rnn (GRU)              (None, 10)                840       
_________________________________________________________________
actor_dense_1 (Dense)        (None, 50)                550       
_________________________________________________________________
batch_normalization (BatchNo (None, 50)                200       
_________________________________________________________________
activation (Activation)      (None, 50)                0         
_________________________________________________________________
actor_dense_2 (Dense)        (None, 40)                2040      
_________________________________________________________________
batch_normalization_1 (Batch (None, 40)                160       
_________________________________________________________________
activation_1 (Activation)    (None, 40)                0         
_________________________________________________________________
actor_dense_3 (Dense)        (None, 1)                 41        
_________________________________________________________________
tf_op_layer_actions_scaling  [(None, 1)]               0         
=================================================================
Total params: 3,911
Trainable params: 3,731
Non-trainable params: 180
_________________________________________________________________
None
Model: "critic_network"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
critic_input_state (InputLayer) [(None, 4, 2)]       0                                            
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, 3, 16)        80          critic_input_state[0][0]         
__________________________________________________________________________________________________
gru (GRU)                       (None, 10)           840         conv1d_2[0][0]                   
__________________________________________________________________________________________________
critic_dense_1 (Dense)          (None, 50)           550         gru[0][0]                        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 50)           200         critic_dense_1[0][0]             
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 50)           0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
critic_input_action (InputLayer [(None, 1)]          0                                            
__________________________________________________________________________________________________
critic_dense_2_state (Dense)    (None, 20)           1020        activation_4[0][0]               
__________________________________________________________________________________________________
critic_dense_2_action (Dense)   (None, 20)           40          critic_input_action[0][0]        
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 40)           0           critic_dense_2_state[0][0]       
                                                                 critic_dense_2_action[0][0]      
__________________________________________________________________________________________________
critic_dense_3_state (Dense)    (None, 20)           820         concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 20)           80          critic_dense_3_state[0][0]       
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 20)           0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
Q_val (Dense)                   (None, 1)            21          activation_5[0][0]               
==================================================================================================
Total params: 3,651
Trainable params: 3,511
Non-trainable params: 140
__________________________________________________________________________________________________
None
starting the simulation
running - train_rnn_cbf
| Reward: 10074.3311 | Episode: 0 | Qmax: 9.5556
| Reward: 9856.2878 | Episode: 1 | Qmax: 18.4017
| Reward: 9856.4168 | Episode: 2 | Qmax: 30.6549
| Reward: 10237.4338 | Episode: 3 | Qmax: 48.1378
| Reward: 11251.1723 | Episode: 4 | Qmax: 66.4889
| Reward: 11251.7992 | Episode: 5 | Qmax: 89.3380
| Reward: 11251.5367 | Episode: 6 | Qmax: 114.2458
| Reward: 11252.3549 | Episode: 7 | Qmax: 140.1668
| Reward: 11251.7794 | Episode: 8 | Qmax: 165.1991
| Reward: 11252.0815 | Episode: 9 | Qmax: 189.0525
| Reward: 11251.8906 | Episode: 10 | Qmax: 211.8377
| Reward: 11251.7220 | Episode: 11 | Qmax: 233.7706
| Reward: 11251.5111 | Episode: 12 | Qmax: 254.0321
| Reward: 11251.5859 | Episode: 13 | Qmax: 272.3552
| Reward: 11252.1344 | Episode: 14 | Qmax: 289.2580
| Reward: 11251.1349 | Episode: 15 | Qmax: 304.6440
| Reward: 11251.9040 | Episode: 16 | Qmax: 318.3692
| Reward: 11251.7389 | Episode: 17 | Qmax: 330.5061
| Reward: 11251.3499 | Episode: 18 | Qmax: 340.8332
| Reward: 11251.6583 | Episode: 19 | Qmax: 350.1873
| Reward: 11251.8702 | Episode: 20 | Qmax: 358.1582
| Reward: 11251.8824 | Episode: 21 | Qmax: 365.8039
| Reward: 11251.9936 | Episode: 22 | Qmax: 373.0956
| Reward: 11251.8474 | Episode: 23 | Qmax: 379.8872
| Reward: 11252.0806 | Episode: 24 | Qmax: 386.1724
| Reward: 11251.3755 | Episode: 25 | Qmax: 392.3847
| Reward: 11252.1502 | Episode: 26 | Qmax: 398.3136
| Reward: 11251.6856 | Episode: 27 | Qmax: 404.1325
| Reward: 11252.1905 | Episode: 28 | Qmax: 410.0271
| Reward: 11252.0939 | Episode: 29 | Qmax: 415.7816
| Reward: 11252.1896 | Episode: 30 | Qmax: 421.5624
| Reward: 11251.9912 | Episode: 31 | Qmax: 427.2239
| Reward: 11251.7200 | Episode: 32 | Qmax: 433.0104
| Reward: 11251.8633 | Episode: 33 | Qmax: 438.4101
| Reward: 11251.6329 | Episode: 34 | Qmax: 443.7641
| Reward: 11251.8638 | Episode: 35 | Qmax: 448.9560
| Reward: 11252.4258 | Episode: 36 | Qmax: 453.7072
| Reward: 11252.1148 | Episode: 37 | Qmax: 458.6910
| Reward: 11251.5626 | Episode: 38 | Qmax: 463.3102
| Reward: 11251.8828 | Episode: 39 | Qmax: 467.8441
| Reward: 11252.3398 | Episode: 40 | Qmax: 472.2882
| Reward: 11251.7780 | Episode: 41 | Qmax: 476.4448
| Reward: 11251.7725 | Episode: 42 | Qmax: 480.9450
| Reward: 11252.0531 | Episode: 43 | Qmax: 484.9393
| Reward: 11252.0013 | Episode: 44 | Qmax: 489.0819
| Reward: 11251.8225 | Episode: 45 | Qmax: 493.3136
| Reward: 11251.5836 | Episode: 46 | Qmax: 497.4264
| Reward: 11252.0586 | Episode: 47 | Qmax: 501.8788
| Reward: 11251.7281 | Episode: 48 | Qmax: 506.1785
| Reward: 11252.0619 | Episode: 49 | Qmax: 509.9548
| Reward: 11251.5666 | Episode: 50 | Qmax: 514.3345
| Reward: 11251.9349 | Episode: 51 | Qmax: 518.1236
| Reward: 11251.7326 | Episode: 52 | Qmax: 522.3266
| Reward: 11251.5765 | Episode: 53 | Qmax: 526.3388
| Reward: 11251.8304 | Episode: 54 | Qmax: 530.2368
| Reward: 11252.2793 | Episode: 55 | Qmax: 533.8239
| Reward: 11251.8308 | Episode: 56 | Qmax: 537.6158
| Reward: 11251.7851 | Episode: 57 | Qmax: 541.3065
| Reward: 11251.8464 | Episode: 58 | Qmax: 544.5767
| Reward: 11251.4158 | Episode: 59 | Qmax: 548.2507
| Reward: 11251.7744 | Episode: 60 | Qmax: 552.0983
| Reward: 11252.0193 | Episode: 61 | Qmax: 555.5893
| Reward: 11251.9836 | Episode: 62 | Qmax: 559.2017
| Reward: 11251.8993 | Episode: 63 | Qmax: 562.0972
| Reward: 11252.0857 | Episode: 64 | Qmax: 564.8587
| Reward: 11251.6491 | Episode: 65 | Qmax: 567.6388
| Reward: 11251.9192 | Episode: 66 | Qmax: 571.0988
| Reward: 11251.7956 | Episode: 67 | Qmax: 575.5775
| Reward: 11251.7064 | Episode: 68 | Qmax: 578.4068
| Reward: 11251.7719 | Episode: 69 | Qmax: 581.8644
| Reward: 11252.3178 | Episode: 70 | Qmax: 584.4619
| Reward: 11251.4978 | Episode: 71 | Qmax: 587.2950
| Reward: 11251.7940 | Episode: 72 | Qmax: 590.2200
| Reward: 11252.0574 | Episode: 73 | Qmax: 593.5504
| Reward: 11251.4966 | Episode: 74 | Qmax: 597.0255
| Reward: 11252.3214 | Episode: 75 | Qmax: 600.4930
| Reward: 11251.9730 | Episode: 76 | Qmax: 604.0317
| Reward: 11252.1803 | Episode: 77 | Qmax: 606.7273
| Reward: 11252.2043 | Episode: 78 | Qmax: 610.0972
| Reward: 11252.1530 | Episode: 79 | Qmax: 613.1451
| Reward: 11251.7025 | Episode: 80 | Qmax: 616.1901
| Reward: 11251.6113 | Episode: 81 | Qmax: 619.0919
| Reward: 11252.2876 | Episode: 82 | Qmax: 622.1834
| Reward: 11252.4017 | Episode: 83 | Qmax: 624.2791
| Reward: 11252.1950 | Episode: 84 | Qmax: 627.8375
| Reward: 11252.1060 | Episode: 85 | Qmax: 629.6046
| Reward: 11251.7890 | Episode: 86 | Qmax: 632.0954
| Reward: 11251.9955 | Episode: 87 | Qmax: 634.1259
| Reward: 11251.9396 | Episode: 88 | Qmax: 635.4329
| Reward: 11252.0892 | Episode: 89 | Qmax: 637.8613
| Reward: 11252.1267 | Episode: 90 | Qmax: 640.1558
| Reward: 11251.7472 | Episode: 91 | Qmax: 642.7757
| Reward: 11252.3506 | Episode: 92 | Qmax: 645.4619
| Reward: 11252.0991 | Episode: 93 | Qmax: 646.6400
| Reward: 11251.8476 | Episode: 94 | Qmax: 648.7815
| Reward: 11252.5562 | Episode: 95 | Qmax: 650.9312
| Reward: 11251.8974 | Episode: 96 | Qmax: 652.6136
| Reward: 11252.2227 | Episode: 97 | Qmax: 654.5864
| Reward: 11251.8662 | Episode: 98 | Qmax: 653.2759
| Reward: 11252.1119 | Episode: 99 | Qmax: 654.2360
| Reward: 11252.3162 | Episode: 100 | Qmax: 658.0509
| Reward: 11252.3432 | Episode: 101 | Qmax: 659.6668
| Reward: 11252.0334 | Episode: 102 | Qmax: 662.2420
| Reward: 11252.2069 | Episode: 103 | Qmax: 664.2996
| Reward: 11251.5660 | Episode: 104 | Qmax: 665.7607
| Reward: 11251.7851 | Episode: 105 | Qmax: 667.9177
| Reward: 11252.2867 | Episode: 106 | Qmax: 671.7229
| Reward: 11252.0127 | Episode: 107 | Qmax: 675.4037
| Reward: 11251.8742 | Episode: 108 | Qmax: 661.1474
| Reward: 11244.4526 | Episode: 109 | Qmax: 636.6643
| Reward: 9874.6446 | Episode: 110 | Qmax: 607.8940
| Reward: 9856.0384 | Episode: 111 | Qmax: 580.3914
| Reward: 9856.2309 | Episode: 112 | Qmax: 557.0758
| Reward: 9856.4082 | Episode: 113 | Qmax: 536.9894
| Reward: 9856.0671 | Episode: 114 | Qmax: 521.2650
| Reward: 9856.0719 | Episode: 115 | Qmax: 508.8096
| Reward: 9855.6889 | Episode: 116 | Qmax: 503.1533
| Reward: 9856.1960 | Episode: 117 | Qmax: 501.1728
| Reward: 9855.8148 | Episode: 118 | Qmax: 495.2462
| Reward: 9856.0403 | Episode: 119 | Qmax: 487.4518
| Reward: 9855.8080 | Episode: 120 | Qmax: 478.0809
| Reward: 9856.0131 | Episode: 121 | Qmax: 468.6123
| Reward: 9855.9947 | Episode: 122 | Qmax: 459.7363
| Reward: 9856.1709 | Episode: 123 | Qmax: 449.3442
| Reward: 9856.1142 | Episode: 124 | Qmax: 439.8945
| Reward: 9855.7669 | Episode: 125 | Qmax: 432.2683
| Reward: 9855.8033 | Episode: 126 | Qmax: 427.2896
| Reward: 9856.2979 | Episode: 127 | Qmax: 424.5647
| Reward: 9856.1033 | Episode: 128 | Qmax: 424.3615
| Reward: 9855.9590 | Episode: 129 | Qmax: 426.6351
| Reward: 9856.0268 | Episode: 130 | Qmax: 430.6218
| Reward: 9856.2639 | Episode: 131 | Qmax: 435.2917
| Reward: 9856.1443 | Episode: 132 | Qmax: 441.3962
| Reward: 9856.0284 | Episode: 133 | Qmax: 446.6432
| Reward: 9856.2170 | Episode: 134 | Qmax: 450.4556
| Reward: 9855.9073 | Episode: 135 | Qmax: 452.5102
| Reward: 9855.8955 | Episode: 136 | Qmax: 454.5687
| Reward: 9856.0022 | Episode: 137 | Qmax: 460.0035
| Reward: 9855.6601 | Episode: 138 | Qmax: 470.7455
| Reward: 9856.0848 | Episode: 139 | Qmax: 481.3918
| Reward: 10699.6525 | Episode: 140 | Qmax: 495.9816
| Reward: 11251.7902 | Episode: 141 | Qmax: 516.4364
| Reward: 11252.0044 | Episode: 142 | Qmax: 533.1056
| Reward: 11251.6208 | Episode: 143 | Qmax: 549.0311
| Reward: 11251.5101 | Episode: 144 | Qmax: 562.5236
| Reward: 11251.9015 | Episode: 145 | Qmax: 574.0602
| Reward: 11252.5837 | Episode: 146 | Qmax: 583.3626
| Reward: 11252.0049 | Episode: 147 | Qmax: 594.6639
| Reward: 11251.9637 | Episode: 148 | Qmax: 600.8375
| Reward: 11251.8144 | Episode: 149 | Qmax: 611.0333
| Reward: 11251.8470 | Episode: 150 | Qmax: 627.3330
| Reward: 11252.2148 | Episode: 151 | Qmax: 645.9779
| Reward: 11252.2940 | Episode: 152 | Qmax: 664.4472
| Reward: 11251.2281 | Episode: 153 | Qmax: 679.5778
| Reward: 11252.2905 | Episode: 154 | Qmax: 688.3612
| Reward: 11251.6626 | Episode: 155 | Qmax: 698.2836
| Reward: 11251.6087 | Episode: 156 | Qmax: 707.0590
| Reward: 11252.4876 | Episode: 157 | Qmax: 719.8863
| Reward: 11251.5522 | Episode: 158 | Qmax: 734.9519
| Reward: 11252.1315 | Episode: 159 | Qmax: 752.6335
| Reward: 11251.6448 | Episode: 160 | Qmax: 773.8893
| Reward: 11251.9116 | Episode: 161 | Qmax: 797.0394
| Reward: 11252.3469 | Episode: 162 | Qmax: 809.9941
| Reward: 11251.9800 | Episode: 163 | Qmax: 826.3268
| Reward: 11251.9514 | Episode: 164 | Qmax: 841.3247
| Reward: 11251.8987 | Episode: 165 | Qmax: 847.9716
| Reward: 11252.6223 | Episode: 166 | Qmax: 856.3042
| Reward: 11251.8422 | Episode: 167 | Qmax: 863.5855
| Reward: 11251.7060 | Episode: 168 | Qmax: 878.8146
| Reward: 11251.7432 | Episode: 169 | Qmax: 891.5768
| Reward: 11251.5936 | Episode: 170 | Qmax: 901.3180
| Reward: 11252.1268 | Episode: 171 | Qmax: 911.7191
| Reward: 11251.3489 | Episode: 172 | Qmax: 918.3207
| Reward: 11252.3792 | Episode: 173 | Qmax: 925.2106
| Reward: 11251.5245 | Episode: 174 | Qmax: 929.7511
| Reward: 11252.2032 | Episode: 175 | Qmax: 930.3246
| Reward: 11251.9862 | Episode: 176 | Qmax: 932.2542
| Reward: 11252.2444 | Episode: 177 | Qmax: 929.7860
| Reward: 11251.5550 | Episode: 178 | Qmax: 928.9796
| Reward: 11251.6350 | Episode: 179 | Qmax: 930.0326
| Reward: 11251.7313 | Episode: 180 | Qmax: 932.9738
| Reward: 11252.1888 | Episode: 181 | Qmax: 933.5853
| Reward: 11252.3041 | Episode: 182 | Qmax: 939.1571
| Reward: 11251.7829 | Episode: 183 | Qmax: 943.1794
| Reward: 11251.9124 | Episode: 184 | Qmax: 950.0796
| Reward: 11252.0116 | Episode: 185 | Qmax: 958.3241
| Reward: 11252.0650 | Episode: 186 | Qmax: 965.5125
| Reward: 11251.8346 | Episode: 187 | Qmax: 975.4011
| Reward: 11252.0598 | Episode: 188 | Qmax: 983.9664
| Reward: 11251.9584 | Episode: 189 | Qmax: 991.9736
| Reward: 11252.2364 | Episode: 190 | Qmax: 1003.0584
| Reward: 11251.7135 | Episode: 191 | Qmax: 1021.7702
| Reward: 11251.6106 | Episode: 192 | Qmax: 1040.1995
| Reward: 11251.9435 | Episode: 193 | Qmax: 1058.0790
| Reward: 11252.1093 | Episode: 194 | Qmax: 1072.4573
| Reward: 11252.1370 | Episode: 195 | Qmax: 1084.1019
| Reward: 11252.3090 | Episode: 196 | Qmax: 1103.0223
| Reward: 11252.1182 | Episode: 197 | Qmax: 1124.6896
| Reward: 11251.7523 | Episode: 198 | Qmax: 1146.5657
| Reward: 11252.2783 | Episode: 199 | Qmax: 1173.4772
saving weights
Plotting an new testing environment
