summary_dir /afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=3
use_gpu True
save_model True
load_model False
random_seed 1754
buffer_size 1000000
max_episodes 200
max_episode_len 1464
mini_batch_size 300
actor_lr 0.0001
critic_lr 0.001
gamma 0.99
noise_var 0.0925
scaling True
state_dim 2
action_dim 1
action_bound [1.]
discretization_time 0.001
T_set_max_min [23.0, 26.0]
T_max_min [22.0, 23.0]
time_steps 3
actor_rnn 10
actor_l1 50
actor_l2 40
critic_rnn 10
critic_l1 50
critic_l2 20
tau 0.001
{'T_max_min': [22.0, 23.0],
 'T_set_max_min': [23.0, 26.0],
 'action_bound': array([1.], dtype=float32),
 'action_dim': 1,
 'actor_l1': 50,
 'actor_l2': 40,
 'actor_lr': 0.0001,
 'actor_rnn': 10,
 'buffer_size': 1000000,
 'critic_l1': 50,
 'critic_l2': 20,
 'critic_lr': 0.001,
 'critic_rnn': 10,
 'discretization_time': 0.001,
 'gamma': 0.99,
 'load_model': False,
 'max_episode_len': 1464,
 'max_episodes': 200,
 'mini_batch_size': 300,
 'noise_var': 0.0925,
 'random_seed': 1754,
 'save_model': True,
 'scaling': True,
 'state_dim': 2,
 'summary_dir': '/afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=3',
 'tau': 0.001,
 'time_steps': 3,
 'use_gpu': True}
starting the scaling
finished the scaling
[0.47954101 0.028215  ] [ 23.99911766 -28.57141944]
initalizing the actor and critic func
loading the weights
Model: "actor_network"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
actor_input_state (InputLaye [(None, 3, 2)]            0         
_________________________________________________________________
conv1d (Conv1D)              (None, 2, 16)             80        
_________________________________________________________________
actor_rnn (GRU)              (None, 10)                840       
_________________________________________________________________
actor_dense_1 (Dense)        (None, 50)                550       
_________________________________________________________________
batch_normalization (BatchNo (None, 50)                200       
_________________________________________________________________
activation (Activation)      (None, 50)                0         
_________________________________________________________________
actor_dense_2 (Dense)        (None, 40)                2040      
_________________________________________________________________
batch_normalization_1 (Batch (None, 40)                160       
_________________________________________________________________
activation_1 (Activation)    (None, 40)                0         
_________________________________________________________________
actor_dense_3 (Dense)        (None, 1)                 41        
_________________________________________________________________
tf_op_layer_actions_scaling  [(None, 1)]               0         
=================================================================
Total params: 3,911
Trainable params: 3,731
Non-trainable params: 180
_________________________________________________________________
None
Model: "critic_network"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
critic_input_state (InputLayer) [(None, 3, 2)]       0                                            
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, 2, 16)        80          critic_input_state[0][0]         
__________________________________________________________________________________________________
gru (GRU)                       (None, 10)           840         conv1d_2[0][0]                   
__________________________________________________________________________________________________
critic_dense_1 (Dense)          (None, 50)           550         gru[0][0]                        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 50)           200         critic_dense_1[0][0]             
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 50)           0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
critic_input_action (InputLayer [(None, 1)]          0                                            
__________________________________________________________________________________________________
critic_dense_2_state (Dense)    (None, 20)           1020        activation_4[0][0]               
__________________________________________________________________________________________________
critic_dense_2_action (Dense)   (None, 20)           40          critic_input_action[0][0]        
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 40)           0           critic_dense_2_state[0][0]       
                                                                 critic_dense_2_action[0][0]      
__________________________________________________________________________________________________
critic_dense_3_state (Dense)    (None, 20)           820         concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 20)           80          critic_dense_3_state[0][0]       
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 20)           0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
Q_val (Dense)                   (None, 1)            21          activation_5[0][0]               
==================================================================================================
Total params: 3,651
Trainable params: 3,511
Non-trainable params: 140
__________________________________________________________________________________________________
None
starting the simulation
running - train_rnn_cbf
| Reward: 11295.1614 | Episode: 0 | Qmax: 10.0202
| Reward: 11295.1613 | Episode: 1 | Qmax: 19.3420
| Reward: 11295.1593 | Episode: 2 | Qmax: 31.4232
| Reward: 11295.1702 | Episode: 3 | Qmax: 45.7699
| Reward: 11296.0847 | Episode: 4 | Qmax: 64.0787
| Reward: 11299.1177 | Episode: 5 | Qmax: 90.0504
| Reward: 11299.6966 | Episode: 6 | Qmax: 131.1937
| Reward: 11299.1741 | Episode: 7 | Qmax: 194.4011
| Reward: 11299.2828 | Episode: 8 | Qmax: 283.4420
| Reward: 11299.4782 | Episode: 9 | Qmax: 409.5634
| Reward: 11299.5051 | Episode: 10 | Qmax: 555.9831
| Reward: 11299.0200 | Episode: 11 | Qmax: 682.3968
| Reward: 11298.9545 | Episode: 12 | Qmax: 765.8988
| Reward: 11299.4502 | Episode: 13 | Qmax: 810.7761
| Reward: 11299.5777 | Episode: 14 | Qmax: 835.4110
| Reward: 11299.4602 | Episode: 15 | Qmax: 852.8853
| Reward: 11299.1398 | Episode: 16 | Qmax: 863.6024
| Reward: 11299.2624 | Episode: 17 | Qmax: 868.8841
| Reward: 11299.5765 | Episode: 18 | Qmax: 872.8330
| Reward: 11299.8245 | Episode: 19 | Qmax: 896.6726
| Reward: 11299.0980 | Episode: 20 | Qmax: 923.3443
| Reward: 11299.5278 | Episode: 21 | Qmax: 941.4795
| Reward: 11299.3793 | Episode: 22 | Qmax: 963.8729
| Reward: 11299.2101 | Episode: 23 | Qmax: 995.7177
| Reward: 11299.3059 | Episode: 24 | Qmax: 1032.5320
| Reward: 11299.4677 | Episode: 25 | Qmax: 1041.4770
| Reward: 11299.1497 | Episode: 26 | Qmax: 1037.2673
| Reward: 11299.6552 | Episode: 27 | Qmax: 1033.2390
| Reward: 11299.3906 | Episode: 28 | Qmax: 1035.9399
| Reward: 11299.4420 | Episode: 29 | Qmax: 1043.7964
| Reward: 11299.2734 | Episode: 30 | Qmax: 1044.0267
| Reward: 11299.4815 | Episode: 31 | Qmax: 1041.2564
| Reward: 11299.6122 | Episode: 32 | Qmax: 1037.7375
| Reward: 11299.4703 | Episode: 33 | Qmax: 1026.5498
| Reward: 11299.2510 | Episode: 34 | Qmax: 1006.3231
| Reward: 11299.1937 | Episode: 35 | Qmax: 984.9649
| Reward: 11298.9894 | Episode: 36 | Qmax: 985.7522
| Reward: 11299.3810 | Episode: 37 | Qmax: 999.3228
| Reward: 11299.5242 | Episode: 38 | Qmax: 1015.7755
| Reward: 11299.6693 | Episode: 39 | Qmax: 1038.1459
| Reward: 11299.5153 | Episode: 40 | Qmax: 1075.4242
| Reward: 11299.4765 | Episode: 41 | Qmax: 1117.8187
| Reward: 11299.6390 | Episode: 42 | Qmax: 1161.1126
| Reward: 11299.3036 | Episode: 43 | Qmax: 1210.4158
| Reward: 11299.5299 | Episode: 44 | Qmax: 1260.3578
| Reward: 11299.5486 | Episode: 45 | Qmax: 1305.3160
| Reward: 11299.4253 | Episode: 46 | Qmax: 1338.2626
| Reward: 11299.6516 | Episode: 47 | Qmax: 1360.3881
| Reward: 11299.3116 | Episode: 48 | Qmax: 1379.4229
| Reward: 11299.8188 | Episode: 49 | Qmax: 1397.6370
| Reward: 11299.5043 | Episode: 50 | Qmax: 1413.0351
| Reward: 11299.3875 | Episode: 51 | Qmax: 1423.9209
| Reward: 11298.8934 | Episode: 52 | Qmax: 1438.3360
| Reward: 11299.5273 | Episode: 53 | Qmax: 1446.7303
| Reward: 11299.0649 | Episode: 54 | Qmax: 1469.4521
| Reward: 11299.6254 | Episode: 55 | Qmax: 1496.7149
| Reward: 11299.3761 | Episode: 56 | Qmax: 1514.7952
| Reward: 11299.2760 | Episode: 57 | Qmax: 1531.6471
| Reward: 11299.6595 | Episode: 58 | Qmax: 1546.8686
| Reward: 11299.5015 | Episode: 59 | Qmax: 1560.8622
| Reward: 11299.2800 | Episode: 60 | Qmax: 1573.5827
| Reward: 11299.0775 | Episode: 61 | Qmax: 1539.7631
| Reward: 11299.7732 | Episode: 62 | Qmax: 1495.8083
| Reward: 11299.7854 | Episode: 63 | Qmax: 1447.8193
| Reward: 11299.6194 | Episode: 64 | Qmax: 1397.6205
| Reward: 11299.2867 | Episode: 65 | Qmax: 1350.1406
| Reward: 11299.3645 | Episode: 66 | Qmax: 1302.8698
| Reward: 11299.4325 | Episode: 67 | Qmax: 1250.4717
| Reward: 11299.1220 | Episode: 68 | Qmax: 1199.9042
| Reward: 11300.1347 | Episode: 69 | Qmax: 1162.9738
| Reward: 11299.1010 | Episode: 70 | Qmax: 1140.9840
| Reward: 11299.7246 | Episode: 71 | Qmax: 1125.7728
| Reward: 11299.5071 | Episode: 72 | Qmax: 1111.9900
| Reward: 11299.6133 | Episode: 73 | Qmax: 1100.5168
| Reward: 11299.2903 | Episode: 74 | Qmax: 1095.7996
| Reward: 11299.4910 | Episode: 75 | Qmax: 1096.6092
| Reward: 11299.4820 | Episode: 76 | Qmax: 1101.7628
| Reward: 11299.2631 | Episode: 77 | Qmax: 1112.2693
| Reward: 11299.0853 | Episode: 78 | Qmax: 1121.3060
| Reward: 11299.4773 | Episode: 79 | Qmax: 1125.2761
| Reward: 11299.4886 | Episode: 80 | Qmax: 1127.9827
| Reward: 11299.4629 | Episode: 81 | Qmax: 1128.3208
| Reward: 11299.5018 | Episode: 82 | Qmax: 1122.4725
| Reward: 11299.6859 | Episode: 83 | Qmax: 1114.5907
| Reward: 11299.4992 | Episode: 84 | Qmax: 1101.4751
| Reward: 11299.1389 | Episode: 85 | Qmax: 1085.7935
| Reward: 11299.0215 | Episode: 86 | Qmax: 1080.1568
| Reward: 11299.4790 | Episode: 87 | Qmax: 1089.7461
| Reward: 11299.3262 | Episode: 88 | Qmax: 1102.7210
| Reward: 11299.5317 | Episode: 89 | Qmax: 1114.4834
| Reward: 11299.5747 | Episode: 90 | Qmax: 1130.1528
| Reward: 11299.4179 | Episode: 91 | Qmax: 1148.5657
| Reward: 11299.5933 | Episode: 92 | Qmax: 1170.7493
| Reward: 11299.2596 | Episode: 93 | Qmax: 1195.7691
| Reward: 11299.2945 | Episode: 94 | Qmax: 1222.9223
| Reward: 11299.2848 | Episode: 95 | Qmax: 1249.4589
| Reward: 11299.4635 | Episode: 96 | Qmax: 1272.4869
| Reward: 11299.9883 | Episode: 97 | Qmax: 1295.3417
| Reward: 11299.3127 | Episode: 98 | Qmax: 1315.6187
| Reward: 11299.5868 | Episode: 99 | Qmax: 1334.9128
| Reward: 11299.4262 | Episode: 100 | Qmax: 1351.6719
| Reward: 11299.4545 | Episode: 101 | Qmax: 1370.3507
| Reward: 11299.0598 | Episode: 102 | Qmax: 1386.6460
| Reward: 11299.4028 | Episode: 103 | Qmax: 1400.2362
| Reward: 11299.4379 | Episode: 104 | Qmax: 1417.6240
| Reward: 11299.6766 | Episode: 105 | Qmax: 1438.5938
| Reward: 11299.2759 | Episode: 106 | Qmax: 1467.2803
| Reward: 11299.7904 | Episode: 107 | Qmax: 1498.3807
| Reward: 11299.6317 | Episode: 108 | Qmax: 1532.7939
| Reward: 11299.3088 | Episode: 109 | Qmax: 1570.4170
| Reward: 11299.2821 | Episode: 110 | Qmax: 1609.1949
| Reward: 11299.3750 | Episode: 111 | Qmax: 1639.1254
| Reward: 11299.5834 | Episode: 112 | Qmax: 1627.3866
| Reward: 11299.4627 | Episode: 113 | Qmax: 1616.6781
| Reward: 11299.6407 | Episode: 114 | Qmax: 1606.5234
| Reward: 11299.3447 | Episode: 115 | Qmax: 1597.0850
| Reward: 11299.4592 | Episode: 116 | Qmax: 1589.9161
| Reward: 11299.3707 | Episode: 117 | Qmax: 1587.7551
| Reward: 11299.3213 | Episode: 118 | Qmax: 1585.5776
| Reward: 11299.6342 | Episode: 119 | Qmax: 1586.5781
| Reward: 11299.3070 | Episode: 120 | Qmax: 1591.9871
| Reward: 11299.3054 | Episode: 121 | Qmax: 1598.2616
| Reward: 11299.4572 | Episode: 122 | Qmax: 1608.3239
| Reward: 11299.3840 | Episode: 123 | Qmax: 1620.7082
| Reward: 11299.3180 | Episode: 124 | Qmax: 1635.8624
| Reward: 11299.1858 | Episode: 125 | Qmax: 1651.0246
| Reward: 11299.5157 | Episode: 126 | Qmax: 1644.7397
| Reward: 11299.3950 | Episode: 127 | Qmax: 1626.6231
| Reward: 11299.1635 | Episode: 128 | Qmax: 1614.4665
| Reward: 11299.3290 | Episode: 129 | Qmax: 1606.3414
| Reward: 11299.7286 | Episode: 130 | Qmax: 1597.1279
| Reward: 11299.4573 | Episode: 131 | Qmax: 1586.8727
| Reward: 11299.2897 | Episode: 132 | Qmax: 1578.3744
| Reward: 11299.7534 | Episode: 133 | Qmax: 1568.8398
| Reward: 11299.3123 | Episode: 134 | Qmax: 1561.5060
| Reward: 11299.3605 | Episode: 135 | Qmax: 1550.1806
| Reward: 11299.4538 | Episode: 136 | Qmax: 1544.0547
| Reward: 11299.2570 | Episode: 137 | Qmax: 1533.2215
| Reward: 11299.5921 | Episode: 138 | Qmax: 1522.1137
| Reward: 11299.6671 | Episode: 139 | Qmax: 1511.1627
| Reward: 11299.0767 | Episode: 140 | Qmax: 1498.9588
| Reward: 11299.8333 | Episode: 141 | Qmax: 1489.4267
| Reward: 11299.4365 | Episode: 142 | Qmax: 1479.8467
| Reward: 11299.1691 | Episode: 143 | Qmax: 1471.0652
| Reward: 11299.5181 | Episode: 144 | Qmax: 1460.5901
| Reward: 11299.5014 | Episode: 145 | Qmax: 1453.5101
| Reward: 11299.4880 | Episode: 146 | Qmax: 1442.2285
| Reward: 11299.3850 | Episode: 147 | Qmax: 1417.9268
| Reward: 11299.3810 | Episode: 148 | Qmax: 1407.3296
| Reward: 11299.3213 | Episode: 149 | Qmax: 1404.1531
| Reward: 11299.4741 | Episode: 150 | Qmax: 1400.2621
| Reward: 11298.9897 | Episode: 151 | Qmax: 1395.1993
| Reward: 11299.5411 | Episode: 152 | Qmax: 1389.3308
| Reward: 11299.0569 | Episode: 153 | Qmax: 1382.2981
| Reward: 11299.3053 | Episode: 154 | Qmax: 1382.2624
| Reward: 11299.3024 | Episode: 155 | Qmax: 1381.5980
| Reward: 11299.3971 | Episode: 156 | Qmax: 1367.8770
| Reward: 11299.3604 | Episode: 157 | Qmax: 1351.5625
| Reward: 11299.2921 | Episode: 158 | Qmax: 1336.0286
| Reward: 11299.1355 | Episode: 159 | Qmax: 1329.0737
| Reward: 11299.7100 | Episode: 160 | Qmax: 1323.6151
| Reward: 11299.8110 | Episode: 161 | Qmax: 1328.2072
| Reward: 11299.4621 | Episode: 162 | Qmax: 1340.7323
| Reward: 11299.5719 | Episode: 163 | Qmax: 1337.1926
| Reward: 11299.1194 | Episode: 164 | Qmax: 1348.1429
| Reward: 11299.0194 | Episode: 165 | Qmax: 1382.8497
| Reward: 11298.7499 | Episode: 166 | Qmax: 1425.7790
| Reward: 11299.2245 | Episode: 167 | Qmax: 1486.3808
| Reward: 11299.0716 | Episode: 168 | Qmax: 1531.2862
| Reward: 11299.5908 | Episode: 169 | Qmax: 1542.0690
| Reward: 11299.0801 | Episode: 170 | Qmax: 1521.5401
| Reward: 11299.1256 | Episode: 171 | Qmax: 1518.2096
| Reward: 11299.4743 | Episode: 172 | Qmax: 1504.8762
| Reward: 11299.3294 | Episode: 173 | Qmax: 1477.6716
| Reward: 11299.7729 | Episode: 174 | Qmax: 1430.4190
| Reward: 11299.0499 | Episode: 175 | Qmax: 1377.7829
| Reward: 11299.5552 | Episode: 176 | Qmax: 1319.0164
| Reward: 11299.0483 | Episode: 177 | Qmax: 1270.8833
| Reward: 11299.1201 | Episode: 178 | Qmax: 1216.0426
| Reward: 11299.8444 | Episode: 179 | Qmax: 1180.1611
| Reward: 11299.5217 | Episode: 180 | Qmax: 1136.5387
| Reward: 11299.0617 | Episode: 181 | Qmax: 1074.0090
| Reward: 11299.2941 | Episode: 182 | Qmax: 997.7714
| Reward: 11299.7276 | Episode: 183 | Qmax: 947.9666
| Reward: 11299.5487 | Episode: 184 | Qmax: 886.8299
| Reward: 11299.5423 | Episode: 185 | Qmax: 833.6410
| Reward: 11299.4775 | Episode: 186 | Qmax: 805.6287
| Reward: 11299.5470 | Episode: 187 | Qmax: 799.4973
| Reward: 11299.4516 | Episode: 188 | Qmax: 814.7736
| Reward: 11299.2534 | Episode: 189 | Qmax: 839.9551
| Reward: 11299.6887 | Episode: 190 | Qmax: 866.1167
| Reward: 11299.5443 | Episode: 191 | Qmax: 899.1098
| Reward: 11299.2736 | Episode: 192 | Qmax: 941.3890
| Reward: 11299.5149 | Episode: 193 | Qmax: 985.9391
| Reward: 11299.6911 | Episode: 194 | Qmax: 1033.4517
| Reward: 11299.2854 | Episode: 195 | Qmax: 1082.5241
| Reward: 11299.5112 | Episode: 196 | Qmax: 1140.4307
| Reward: 11299.2102 | Episode: 197 | Qmax: 1165.5182
| Reward: 11299.7824 | Episode: 198 | Qmax: 1210.4788
| Reward: 11298.7956 | Episode: 199 | Qmax: 1265.9458
saving weights
Plotting an new testing environment
