summary_dir /afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=3
use_gpu True
save_model True
load_model False
random_seed 1754
buffer_size 1000000
max_episodes 200
max_episode_len 1464
mini_batch_size 300
actor_lr 0.0001
critic_lr 0.001
gamma 0.99
noise_var 0.0925
scaling True
state_dim 2
action_dim 1
action_bound [1.]
discretization_time 0.001
T_set_max_min [23.0, 26.0]
T_max_min [22.0, 25.0]
time_steps 3
actor_rnn 10
actor_l1 50
actor_l2 40
critic_rnn 10
critic_l1 50
critic_l2 20
tau 0.001
{'T_max_min': [22.0, 25.0],
 'T_set_max_min': [23.0, 26.0],
 'action_bound': array([1.], dtype=float32),
 'action_dim': 1,
 'actor_l1': 50,
 'actor_l2': 40,
 'actor_lr': 0.0001,
 'actor_rnn': 10,
 'buffer_size': 1000000,
 'critic_l1': 50,
 'critic_l2': 20,
 'critic_lr': 0.001,
 'critic_rnn': 10,
 'discretization_time': 0.001,
 'gamma': 0.99,
 'load_model': False,
 'max_episode_len': 1464,
 'max_episodes': 200,
 'mini_batch_size': 300,
 'noise_var': 0.0925,
 'random_seed': 1754,
 'save_model': True,
 'scaling': True,
 'state_dim': 2,
 'summary_dir': '/afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=3',
 'tau': 0.001,
 'time_steps': 3,
 'use_gpu': True}
starting the scaling
finished the scaling
[0.47643477 0.02823579] [ 23.99849476 -28.57182468]
initalizing the actor and critic func
loading the weights
Model: "actor_network"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
actor_input_state (InputLaye [(None, 3, 2)]            0         
_________________________________________________________________
conv1d (Conv1D)              (None, 2, 16)             80        
_________________________________________________________________
actor_rnn (GRU)              (None, 10)                840       
_________________________________________________________________
actor_dense_1 (Dense)        (None, 50)                550       
_________________________________________________________________
batch_normalization (BatchNo (None, 50)                200       
_________________________________________________________________
activation (Activation)      (None, 50)                0         
_________________________________________________________________
actor_dense_2 (Dense)        (None, 40)                2040      
_________________________________________________________________
batch_normalization_1 (Batch (None, 40)                160       
_________________________________________________________________
activation_1 (Activation)    (None, 40)                0         
_________________________________________________________________
actor_dense_3 (Dense)        (None, 1)                 41        
_________________________________________________________________
tf_op_layer_actions_scaling  [(None, 1)]               0         
=================================================================
Total params: 3,911
Trainable params: 3,731
Non-trainable params: 180
_________________________________________________________________
None
Model: "critic_network"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
critic_input_state (InputLayer) [(None, 3, 2)]       0                                            
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, 2, 16)        80          critic_input_state[0][0]         
__________________________________________________________________________________________________
gru (GRU)                       (None, 10)           840         conv1d_2[0][0]                   
__________________________________________________________________________________________________
critic_dense_1 (Dense)          (None, 50)           550         gru[0][0]                        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 50)           200         critic_dense_1[0][0]             
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 50)           0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
critic_input_action (InputLayer [(None, 1)]          0                                            
__________________________________________________________________________________________________
critic_dense_2_state (Dense)    (None, 20)           1020        activation_4[0][0]               
__________________________________________________________________________________________________
critic_dense_2_action (Dense)   (None, 20)           40          critic_input_action[0][0]        
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 40)           0           critic_dense_2_state[0][0]       
                                                                 critic_dense_2_action[0][0]      
__________________________________________________________________________________________________
critic_dense_3_state (Dense)    (None, 20)           820         concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 20)           80          critic_dense_3_state[0][0]       
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 20)           0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
Q_val (Dense)                   (None, 1)            21          activation_5[0][0]               
==================================================================================================
Total params: 3,651
Trainable params: 3,511
Non-trainable params: 140
__________________________________________________________________________________________________
None
starting the simulation
running - train_rnn_cbf
| Reward: 10070.2541 | Episode: 0 | Qmax: 9.4039
| Reward: 9858.1757 | Episode: 1 | Qmax: 17.9617
| Reward: 9858.2336 | Episode: 2 | Qmax: 29.5047
| Reward: 10990.9061 | Episode: 3 | Qmax: 46.6615
| Reward: 11255.6914 | Episode: 4 | Qmax: 80.2792
| Reward: 11255.0445 | Episode: 5 | Qmax: 143.6595
| Reward: 11255.3042 | Episode: 6 | Qmax: 246.1987
| Reward: 11254.9066 | Episode: 7 | Qmax: 391.1367
| Reward: 11255.4088 | Episode: 8 | Qmax: 565.8021
| Reward: 11255.1210 | Episode: 9 | Qmax: 741.8259
| Reward: 11255.3554 | Episode: 10 | Qmax: 896.6956
| Reward: 11254.7177 | Episode: 11 | Qmax: 1017.9396
| Reward: 11255.4797 | Episode: 12 | Qmax: 1109.8912
| Reward: 11255.0738 | Episode: 13 | Qmax: 1183.6311
| Reward: 11255.5070 | Episode: 14 | Qmax: 1243.7146
| Reward: 11255.0478 | Episode: 15 | Qmax: 1292.4729
| Reward: 11255.3418 | Episode: 16 | Qmax: 1333.1822
| Reward: 11255.1662 | Episode: 17 | Qmax: 1366.0854
| Reward: 11255.4587 | Episode: 18 | Qmax: 1392.0060
| Reward: 11255.4914 | Episode: 19 | Qmax: 1413.0847
| Reward: 11255.6300 | Episode: 20 | Qmax: 1429.2415
| Reward: 11255.1811 | Episode: 21 | Qmax: 1441.6524
| Reward: 11255.2301 | Episode: 22 | Qmax: 1449.9833
| Reward: 11255.3246 | Episode: 23 | Qmax: 1454.5382
| Reward: 11255.5658 | Episode: 24 | Qmax: 1456.2411
| Reward: 11254.9298 | Episode: 25 | Qmax: 1455.5630
| Reward: 11255.2586 | Episode: 26 | Qmax: 1453.3340
| Reward: 11255.2209 | Episode: 27 | Qmax: 1449.1283
| Reward: 11255.0543 | Episode: 28 | Qmax: 1442.8523
| Reward: 11255.0045 | Episode: 29 | Qmax: 1435.8709
| Reward: 11255.4040 | Episode: 30 | Qmax: 1426.7018
| Reward: 11255.0072 | Episode: 31 | Qmax: 1418.1449
| Reward: 11254.7395 | Episode: 32 | Qmax: 1408.4652
| Reward: 11255.0024 | Episode: 33 | Qmax: 1398.8295
| Reward: 11255.1355 | Episode: 34 | Qmax: 1389.2970
| Reward: 11255.3286 | Episode: 35 | Qmax: 1378.8964
| Reward: 11254.9333 | Episode: 36 | Qmax: 1368.3716
| Reward: 11255.1401 | Episode: 37 | Qmax: 1358.1804
| Reward: 11255.6768 | Episode: 38 | Qmax: 1347.4771
| Reward: 11255.1145 | Episode: 39 | Qmax: 1337.2246
| Reward: 11255.3377 | Episode: 40 | Qmax: 1325.4253
| Reward: 11255.4766 | Episode: 41 | Qmax: 1316.0830
| Reward: 11255.6247 | Episode: 42 | Qmax: 1305.3317
| Reward: 11255.0516 | Episode: 43 | Qmax: 1296.2464
| Reward: 11255.2970 | Episode: 44 | Qmax: 1286.7826
| Reward: 11255.0677 | Episode: 45 | Qmax: 1277.4401
| Reward: 11255.5527 | Episode: 46 | Qmax: 1268.4844
| Reward: 11255.1535 | Episode: 47 | Qmax: 1259.0115
| Reward: 11255.1502 | Episode: 48 | Qmax: 1250.6336
| Reward: 11255.3697 | Episode: 49 | Qmax: 1241.0525
| Reward: 11255.2343 | Episode: 50 | Qmax: 1233.0877
| Reward: 11254.7002 | Episode: 51 | Qmax: 1225.9046
| Reward: 11255.3305 | Episode: 52 | Qmax: 1217.6090
| Reward: 11255.0252 | Episode: 53 | Qmax: 1208.8876
| Reward: 11255.0358 | Episode: 54 | Qmax: 1201.6811
| Reward: 11255.6650 | Episode: 55 | Qmax: 1193.8289
| Reward: 11255.1691 | Episode: 56 | Qmax: 1185.5931
| Reward: 11255.4222 | Episode: 57 | Qmax: 1178.1159
| Reward: 11255.4521 | Episode: 58 | Qmax: 1170.6635
| Reward: 11255.2111 | Episode: 59 | Qmax: 1163.3869
| Reward: 11255.4750 | Episode: 60 | Qmax: 1156.0809
| Reward: 11255.0458 | Episode: 61 | Qmax: 1149.3143
| Reward: 11254.7657 | Episode: 62 | Qmax: 1143.3269
| Reward: 11255.3705 | Episode: 63 | Qmax: 1136.7554
| Reward: 11255.1690 | Episode: 64 | Qmax: 1130.5793
| Reward: 11255.2269 | Episode: 65 | Qmax: 1125.1478
| Reward: 11255.7201 | Episode: 66 | Qmax: 1119.0023
| Reward: 11255.4202 | Episode: 67 | Qmax: 1113.7261
| Reward: 11255.3926 | Episode: 68 | Qmax: 1108.1191
| Reward: 11255.1576 | Episode: 69 | Qmax: 1104.6398
| Reward: 11255.1511 | Episode: 70 | Qmax: 1097.6671
| Reward: 11254.8937 | Episode: 71 | Qmax: 1092.4154
| Reward: 11255.0929 | Episode: 72 | Qmax: 1088.9158
| Reward: 11255.1973 | Episode: 73 | Qmax: 1084.3399
| Reward: 11255.5022 | Episode: 74 | Qmax: 1079.2065
| Reward: 11255.7152 | Episode: 75 | Qmax: 1074.3613
| Reward: 11255.3805 | Episode: 76 | Qmax: 1069.7197
| Reward: 11255.0410 | Episode: 77 | Qmax: 1064.8709
| Reward: 11255.2290 | Episode: 78 | Qmax: 1060.0462
| Reward: 11255.4384 | Episode: 79 | Qmax: 1055.8526
| Reward: 11255.2119 | Episode: 80 | Qmax: 1052.7303
| Reward: 11255.5979 | Episode: 81 | Qmax: 1049.1029
| Reward: 11255.4343 | Episode: 82 | Qmax: 1044.9872
| Reward: 11255.2437 | Episode: 83 | Qmax: 1041.5934
| Reward: 11255.5760 | Episode: 84 | Qmax: 1038.0621
| Reward: 11255.2367 | Episode: 85 | Qmax: 1034.5840
| Reward: 11255.3761 | Episode: 86 | Qmax: 1031.5588
| Reward: 11255.4972 | Episode: 87 | Qmax: 1028.5869
| Reward: 11254.7981 | Episode: 88 | Qmax: 1024.8835
| Reward: 11254.9077 | Episode: 89 | Qmax: 1022.0650
| Reward: 11255.4829 | Episode: 90 | Qmax: 1018.7932
| Reward: 11255.2096 | Episode: 91 | Qmax: 1014.7469
| Reward: 11255.1786 | Episode: 92 | Qmax: 1009.9611
| Reward: 11254.8212 | Episode: 93 | Qmax: 1006.2664
| Reward: 11255.1349 | Episode: 94 | Qmax: 1004.3310
| Reward: 11254.9733 | Episode: 95 | Qmax: 1002.1590
| Reward: 11255.5800 | Episode: 96 | Qmax: 999.2795
| Reward: 11255.2412 | Episode: 97 | Qmax: 996.7843
| Reward: 11255.3460 | Episode: 98 | Qmax: 993.8063
| Reward: 11255.6111 | Episode: 99 | Qmax: 990.7503
| Reward: 11254.9534 | Episode: 100 | Qmax: 988.3352
| Reward: 11254.8624 | Episode: 101 | Qmax: 985.7216
| Reward: 11255.4231 | Episode: 102 | Qmax: 983.5342
| Reward: 11255.1232 | Episode: 103 | Qmax: 981.9318
| Reward: 11255.1861 | Episode: 104 | Qmax: 979.5638
| Reward: 11255.1104 | Episode: 105 | Qmax: 975.6636
| Reward: 11255.5888 | Episode: 106 | Qmax: 970.2972
| Reward: 11255.1456 | Episode: 107 | Qmax: 966.8108
| Reward: 11255.0005 | Episode: 108 | Qmax: 965.0575
| Reward: 11255.6050 | Episode: 109 | Qmax: 960.1114
| Reward: 11254.5236 | Episode: 110 | Qmax: 958.9871
| Reward: 11255.6565 | Episode: 111 | Qmax: 955.0744
| Reward: 11255.5798 | Episode: 112 | Qmax: 952.1962
| Reward: 11255.4176 | Episode: 113 | Qmax: 948.7009
| Reward: 11255.0300 | Episode: 114 | Qmax: 948.1296
| Reward: 11254.9409 | Episode: 115 | Qmax: 944.8865
| Reward: 11254.8795 | Episode: 116 | Qmax: 942.4935
| Reward: 11255.3432 | Episode: 117 | Qmax: 941.3819
| Reward: 11254.8489 | Episode: 118 | Qmax: 939.4968
| Reward: 11255.6420 | Episode: 119 | Qmax: 938.4185
| Reward: 11255.1969 | Episode: 120 | Qmax: 936.3513
| Reward: 11254.9906 | Episode: 121 | Qmax: 934.8453
| Reward: 11255.1527 | Episode: 122 | Qmax: 933.5752
| Reward: 11255.5086 | Episode: 123 | Qmax: 931.5650
| Reward: 11254.7675 | Episode: 124 | Qmax: 929.1706
| Reward: 11255.5091 | Episode: 125 | Qmax: 926.8589
| Reward: 11255.2384 | Episode: 126 | Qmax: 924.5707
| Reward: 11255.1342 | Episode: 127 | Qmax: 924.0035
| Reward: 11255.5473 | Episode: 128 | Qmax: 922.0050
| Reward: 11255.4472 | Episode: 129 | Qmax: 917.7296
| Reward: 11254.8132 | Episode: 130 | Qmax: 917.4650
| Reward: 11255.0835 | Episode: 131 | Qmax: 914.7826
| Reward: 11255.3004 | Episode: 132 | Qmax: 914.1047
| Reward: 11255.0631 | Episode: 133 | Qmax: 913.9334
| Reward: 11255.5672 | Episode: 134 | Qmax: 913.4704
| Reward: 11255.0110 | Episode: 135 | Qmax: 912.2221
| Reward: 11255.6949 | Episode: 136 | Qmax: 909.4224
| Reward: 11255.7117 | Episode: 137 | Qmax: 908.0609
| Reward: 11255.2439 | Episode: 138 | Qmax: 906.7971
| Reward: 11255.6671 | Episode: 139 | Qmax: 907.2408
| Reward: 11255.1986 | Episode: 140 | Qmax: 906.3856
| Reward: 11255.4755 | Episode: 141 | Qmax: 905.7419
| Reward: 11255.1320 | Episode: 142 | Qmax: 906.3708
| Reward: 11255.2650 | Episode: 143 | Qmax: 906.5757
| Reward: 11255.4761 | Episode: 144 | Qmax: 904.4079
| Reward: 11255.4457 | Episode: 145 | Qmax: 901.3581
| Reward: 11255.4115 | Episode: 146 | Qmax: 901.1245
| Reward: 11255.7328 | Episode: 147 | Qmax: 899.6592
| Reward: 11254.9573 | Episode: 148 | Qmax: 899.9801
| Reward: 11255.2229 | Episode: 149 | Qmax: 901.0624
| Reward: 11255.3957 | Episode: 150 | Qmax: 901.5036
| Reward: 11254.9012 | Episode: 151 | Qmax: 900.7368
| Reward: 11255.4722 | Episode: 152 | Qmax: 899.9086
| Reward: 11254.9852 | Episode: 153 | Qmax: 897.7355
| Reward: 11255.2689 | Episode: 154 | Qmax: 898.6769
| Reward: 11255.1619 | Episode: 155 | Qmax: 898.2296
| Reward: 11255.4106 | Episode: 156 | Qmax: 896.4773
| Reward: 11254.9266 | Episode: 157 | Qmax: 897.3929
| Reward: 11254.7918 | Episode: 158 | Qmax: 896.6861
| Reward: 11254.9206 | Episode: 159 | Qmax: 898.2835
| Reward: 11255.4493 | Episode: 160 | Qmax: 900.6582
| Reward: 11255.5982 | Episode: 161 | Qmax: 904.4947
| Reward: 11255.1924 | Episode: 162 | Qmax: 907.1211
| Reward: 11255.4441 | Episode: 163 | Qmax: 910.4725
| Reward: 11254.8946 | Episode: 164 | Qmax: 912.3341
| Reward: 11254.9822 | Episode: 165 | Qmax: 914.3882
| Reward: 11255.0998 | Episode: 166 | Qmax: 917.7266
| Reward: 11254.9503 | Episode: 167 | Qmax: 923.4961
| Reward: 11255.4113 | Episode: 168 | Qmax: 927.4506
| Reward: 11255.4305 | Episode: 169 | Qmax: 927.5151
| Reward: 11255.4886 | Episode: 170 | Qmax: 929.0476
| Reward: 11255.5153 | Episode: 171 | Qmax: 930.0363
| Reward: 11254.9288 | Episode: 172 | Qmax: 928.1121
| Reward: 11255.2287 | Episode: 173 | Qmax: 926.6626
| Reward: 11254.6977 | Episode: 174 | Qmax: 928.4212
| Reward: 11255.4348 | Episode: 175 | Qmax: 927.0036
| Reward: 11254.9696 | Episode: 176 | Qmax: 927.3934
| Reward: 11255.5344 | Episode: 177 | Qmax: 928.1715
| Reward: 11255.4883 | Episode: 178 | Qmax: 929.7166
| Reward: 11254.7609 | Episode: 179 | Qmax: 930.2357
| Reward: 11254.9331 | Episode: 180 | Qmax: 930.0222
| Reward: 11255.4383 | Episode: 181 | Qmax: 932.6621
| Reward: 11255.2860 | Episode: 182 | Qmax: 931.6954
| Reward: 11254.4199 | Episode: 183 | Qmax: 932.5596
| Reward: 11255.6833 | Episode: 184 | Qmax: 933.0306
| Reward: 11255.0841 | Episode: 185 | Qmax: 933.4040
| Reward: 11255.8961 | Episode: 186 | Qmax: 935.6507
| Reward: 11255.3847 | Episode: 187 | Qmax: 938.9204
| Reward: 11255.3251 | Episode: 188 | Qmax: 938.7239
| Reward: 11255.2345 | Episode: 189 | Qmax: 937.0197
| Reward: 11255.5340 | Episode: 190 | Qmax: 932.2692
| Reward: 11255.0700 | Episode: 191 | Qmax: 930.2698
| Reward: 11255.5803 | Episode: 192 | Qmax: 927.3249
| Reward: 11255.9132 | Episode: 193 | Qmax: 926.7737
| Reward: 11255.2460 | Episode: 194 | Qmax: 927.6322
| Reward: 11255.2410 | Episode: 195 | Qmax: 923.6451
| Reward: 11255.4264 | Episode: 196 | Qmax: 921.9450
| Reward: 11255.5597 | Episode: 197 | Qmax: 919.5645
| Reward: 11254.8937 | Episode: 198 | Qmax: 919.6839
| Reward: 11255.3022 | Episode: 199 | Qmax: 917.9521
saving weights
Plotting an new testing environment
