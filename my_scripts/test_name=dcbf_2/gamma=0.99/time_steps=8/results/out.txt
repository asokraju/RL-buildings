summary_dir /afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=8
use_gpu True
save_model True
load_model False
random_seed 1754
buffer_size 1000000
max_episodes 200
max_episode_len 1464
mini_batch_size 300
actor_lr 0.0001
critic_lr 0.001
gamma 0.99
noise_var 0.0925
scaling True
state_dim 2
action_dim 1
action_bound [1.]
discretization_time 0.001
T_set_max_min [23.0, 26.0]
T_max_min [22.0, 25.0]
time_steps 8
actor_rnn 10
actor_l1 50
actor_l2 40
critic_rnn 10
critic_l1 50
critic_l2 20
tau 0.001
{'T_max_min': [22.0, 25.0],
 'T_set_max_min': [23.0, 26.0],
 'action_bound': array([1.], dtype=float32),
 'action_dim': 1,
 'actor_l1': 50,
 'actor_l2': 40,
 'actor_lr': 0.0001,
 'actor_rnn': 10,
 'buffer_size': 1000000,
 'critic_l1': 50,
 'critic_l2': 20,
 'critic_lr': 0.001,
 'critic_rnn': 10,
 'discretization_time': 0.001,
 'gamma': 0.99,
 'load_model': False,
 'max_episode_len': 1464,
 'max_episodes': 200,
 'mini_batch_size': 300,
 'noise_var': 0.0925,
 'random_seed': 1754,
 'save_model': True,
 'scaling': True,
 'state_dim': 2,
 'summary_dir': '/afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=8',
 'tau': 0.001,
 'time_steps': 8,
 'use_gpu': True}
starting the scaling
finished the scaling
[0.47948819 0.02821621] [ 23.99424757 -28.57968016]
initalizing the actor and critic func
loading the weights
Model: "actor_network"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
actor_input_state (InputLaye [(None, 8, 2)]            0         
_________________________________________________________________
conv1d (Conv1D)              (None, 7, 16)             80        
_________________________________________________________________
actor_rnn (GRU)              (None, 10)                840       
_________________________________________________________________
actor_dense_1 (Dense)        (None, 50)                550       
_________________________________________________________________
batch_normalization (BatchNo (None, 50)                200       
_________________________________________________________________
activation (Activation)      (None, 50)                0         
_________________________________________________________________
actor_dense_2 (Dense)        (None, 40)                2040      
_________________________________________________________________
batch_normalization_1 (Batch (None, 40)                160       
_________________________________________________________________
activation_1 (Activation)    (None, 40)                0         
_________________________________________________________________
actor_dense_3 (Dense)        (None, 1)                 41        
_________________________________________________________________
tf_op_layer_actions_scaling  [(None, 1)]               0         
=================================================================
Total params: 3,911
Trainable params: 3,731
Non-trainable params: 180
_________________________________________________________________
None
Model: "critic_network"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
critic_input_state (InputLayer) [(None, 8, 2)]       0                                            
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, 7, 16)        80          critic_input_state[0][0]         
__________________________________________________________________________________________________
gru (GRU)                       (None, 10)           840         conv1d_2[0][0]                   
__________________________________________________________________________________________________
critic_dense_1 (Dense)          (None, 50)           550         gru[0][0]                        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 50)           200         critic_dense_1[0][0]             
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 50)           0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
critic_input_action (InputLayer [(None, 1)]          0                                            
__________________________________________________________________________________________________
critic_dense_2_state (Dense)    (None, 20)           1020        activation_4[0][0]               
__________________________________________________________________________________________________
critic_dense_2_action (Dense)   (None, 20)           40          critic_input_action[0][0]        
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 40)           0           critic_dense_2_state[0][0]       
                                                                 critic_dense_2_action[0][0]      
__________________________________________________________________________________________________
critic_dense_3_state (Dense)    (None, 20)           820         concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 20)           80          critic_dense_3_state[0][0]       
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 20)           0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
Q_val (Dense)                   (None, 1)            21          activation_5[0][0]               
==================================================================================================
Total params: 3,651
Trainable params: 3,511
Non-trainable params: 140
__________________________________________________________________________________________________
None
starting the simulation
running - train_rnn_cbf
| Reward: 10062.8246 | Episode: 0 | Qmax: 9.4684
| Reward: 9847.9268 | Episode: 1 | Qmax: 18.3008
| Reward: 9847.4443 | Episode: 2 | Qmax: 31.8129
| Reward: 10513.0320 | Episode: 3 | Qmax: 48.8291
| Reward: 11238.4578 | Episode: 4 | Qmax: 69.8560
| Reward: 11238.6469 | Episode: 5 | Qmax: 92.4999
| Reward: 11238.7551 | Episode: 6 | Qmax: 115.8383
| Reward: 11239.0035 | Episode: 7 | Qmax: 139.9037
| Reward: 11239.4479 | Episode: 8 | Qmax: 164.4601
| Reward: 11238.8926 | Episode: 9 | Qmax: 187.8906
| Reward: 11239.0592 | Episode: 10 | Qmax: 208.9143
| Reward: 11239.2371 | Episode: 11 | Qmax: 226.8062
| Reward: 11238.9784 | Episode: 12 | Qmax: 242.7989
| Reward: 11238.8447 | Episode: 13 | Qmax: 258.2948
| Reward: 11239.0126 | Episode: 14 | Qmax: 277.7354
| Reward: 11239.1422 | Episode: 15 | Qmax: 302.6550
| Reward: 11239.0293 | Episode: 16 | Qmax: 330.8598
| Reward: 11239.5165 | Episode: 17 | Qmax: 362.8109
| Reward: 11239.3800 | Episode: 18 | Qmax: 400.6243
| Reward: 11239.1462 | Episode: 19 | Qmax: 444.6495
| Reward: 11238.6460 | Episode: 20 | Qmax: 497.5444
| Reward: 11239.1539 | Episode: 21 | Qmax: 559.3177
| Reward: 11238.9183 | Episode: 22 | Qmax: 634.2758
| Reward: 11239.4901 | Episode: 23 | Qmax: 722.6895
| Reward: 11239.4278 | Episode: 24 | Qmax: 816.2067
| Reward: 11238.9632 | Episode: 25 | Qmax: 911.8764
| Reward: 11238.7920 | Episode: 26 | Qmax: 1008.4455
| Reward: 11239.2357 | Episode: 27 | Qmax: 1100.9080
| Reward: 11239.0270 | Episode: 28 | Qmax: 1185.5951
| Reward: 11239.3382 | Episode: 29 | Qmax: 1264.9665
| Reward: 11239.0075 | Episode: 30 | Qmax: 1337.0880
| Reward: 11238.9533 | Episode: 31 | Qmax: 1408.6143
| Reward: 11239.1243 | Episode: 32 | Qmax: 1480.4447
| Reward: 11238.9973 | Episode: 33 | Qmax: 1559.3992
| Reward: 11238.6618 | Episode: 34 | Qmax: 1638.9044
| Reward: 11238.9628 | Episode: 35 | Qmax: 1718.5617
| Reward: 11238.9308 | Episode: 36 | Qmax: 1803.9878
| Reward: 11238.9846 | Episode: 37 | Qmax: 1877.2040
| Reward: 11239.4274 | Episode: 38 | Qmax: 1946.6054
| Reward: 11238.8775 | Episode: 39 | Qmax: 2011.7818
| Reward: 11238.8313 | Episode: 40 | Qmax: 2071.9687
| Reward: 11238.9372 | Episode: 41 | Qmax: 2137.1286
| Reward: 11238.8486 | Episode: 42 | Qmax: 2201.8815
| Reward: 11238.7493 | Episode: 43 | Qmax: 2285.3428
| Reward: 11238.3267 | Episode: 44 | Qmax: 2383.6576
| Reward: 11239.0318 | Episode: 45 | Qmax: 2501.7535
| Reward: 11239.0192 | Episode: 46 | Qmax: 2639.3482
| Reward: 11239.0379 | Episode: 47 | Qmax: 2795.1537
| Reward: 11239.2693 | Episode: 48 | Qmax: 2965.4266
| Reward: 11238.9948 | Episode: 49 | Qmax: 3145.2163
| Reward: 11239.3159 | Episode: 50 | Qmax: 3326.3191
| Reward: 11239.2002 | Episode: 51 | Qmax: 3513.1474
| Reward: 11238.9636 | Episode: 52 | Qmax: 3700.7009
| Reward: 11239.0602 | Episode: 53 | Qmax: 3893.5894
| Reward: 11239.1634 | Episode: 54 | Qmax: 4082.4623
| Reward: 11239.3938 | Episode: 55 | Qmax: 4230.3647
| Reward: 11238.9377 | Episode: 56 | Qmax: 4341.0302
| Reward: 11238.7267 | Episode: 57 | Qmax: 4461.7227
| Reward: 11239.2539 | Episode: 58 | Qmax: 4582.4363
| Reward: 11238.5937 | Episode: 59 | Qmax: 4694.3026
| Reward: 11239.1073 | Episode: 60 | Qmax: 4804.7970
| Reward: 11238.7765 | Episode: 61 | Qmax: 4940.1678
| Reward: 11238.9090 | Episode: 62 | Qmax: 5090.1587
| Reward: 11239.1189 | Episode: 63 | Qmax: 5285.1532
| Reward: 11239.1175 | Episode: 64 | Qmax: 5519.2444
| Reward: 11239.2384 | Episode: 65 | Qmax: 5757.8436
| Reward: 11238.6554 | Episode: 66 | Qmax: 6009.7583
| Reward: 11238.7255 | Episode: 67 | Qmax: 6292.8961
| Reward: 11238.7861 | Episode: 68 | Qmax: 6627.5611
| Reward: 11239.1594 | Episode: 69 | Qmax: 7016.6894
| Reward: 11238.7723 | Episode: 70 | Qmax: 7498.5784
| Reward: 11239.2183 | Episode: 71 | Qmax: 7988.7272
| Reward: 11239.4001 | Episode: 72 | Qmax: 8476.0517
| Reward: 11238.8153 | Episode: 73 | Qmax: 8930.9014
| Reward: 11239.0748 | Episode: 74 | Qmax: 9335.2820
| Reward: 11238.7123 | Episode: 75 | Qmax: 9717.2266
| Reward: 11238.8260 | Episode: 76 | Qmax: 10164.4134
| Reward: 11238.8323 | Episode: 77 | Qmax: 10604.6031
| Reward: 11239.1255 | Episode: 78 | Qmax: 11137.2342
| Reward: 11238.9210 | Episode: 79 | Qmax: 11756.3108
| Reward: 11238.6259 | Episode: 80 | Qmax: 12435.2351
| Reward: 11238.9829 | Episode: 81 | Qmax: 13163.5729
| Reward: 11238.8581 | Episode: 82 | Qmax: 13993.2643
| Reward: 11238.7913 | Episode: 83 | Qmax: 14923.2400
| Reward: 11238.6182 | Episode: 84 | Qmax: 15873.4859
| Reward: 11238.9427 | Episode: 85 | Qmax: 16867.3554
| Reward: 11239.0538 | Episode: 86 | Qmax: 17804.6847
| Reward: 11238.8467 | Episode: 87 | Qmax: 18835.0552
| Reward: 11239.5585 | Episode: 88 | Qmax: 19888.8007
| Reward: 11238.8926 | Episode: 89 | Qmax: 20866.9629
| Reward: 11238.8972 | Episode: 90 | Qmax: 21895.3693
| Reward: 11239.0595 | Episode: 91 | Qmax: 23123.8295
| Reward: 11239.1683 | Episode: 92 | Qmax: 24820.6348
| Reward: 11239.0465 | Episode: 93 | Qmax: 27711.8739
| Reward: 11239.4941 | Episode: 94 | Qmax: 31204.4722
| Reward: 11239.4896 | Episode: 95 | Qmax: 37951.9899
| Reward: 11239.0596 | Episode: 96 | Qmax: 48965.2919
| Reward: 11238.6348 | Episode: 97 | Qmax: 63964.5437
| Reward: 11238.2833 | Episode: 98 | Qmax: 80787.6706
| Reward: 11239.1302 | Episode: 99 | Qmax: 101317.1859
| Reward: 11239.6576 | Episode: 100 | Qmax: 130283.9092
| Reward: 11239.3574 | Episode: 101 | Qmax: 168928.2625
| Reward: 11239.0145 | Episode: 102 | Qmax: 221919.8603
| Reward: 11238.8741 | Episode: 103 | Qmax: 286509.9676
| Reward: 11238.9391 | Episode: 104 | Qmax: 355239.2320
| Reward: 11238.6849 | Episode: 105 | Qmax: 439583.2531
| Reward: 11239.1681 | Episode: 106 | Qmax: 550081.3751
| Reward: 11239.3908 | Episode: 107 | Qmax: 665543.1988
| Reward: 11239.0159 | Episode: 108 | Qmax: 789592.6726
| Reward: 11239.8821 | Episode: 109 | Qmax: 928233.2236
| Reward: 11239.4166 | Episode: 110 | Qmax: 1057391.5982
| Reward: 11239.0034 | Episode: 111 | Qmax: 1188297.4595
| Reward: 11238.5753 | Episode: 112 | Qmax: 1315530.9357
| Reward: 11239.4305 | Episode: 113 | Qmax: 1435268.8368
| Reward: 11239.4251 | Episode: 114 | Qmax: 1543436.4913
| Reward: 11239.6913 | Episode: 115 | Qmax: 1653103.1590
| Reward: 11238.7730 | Episode: 116 | Qmax: 1760459.1126
| Reward: 11239.3462 | Episode: 117 | Qmax: 1870148.6673
| Reward: 11238.6217 | Episode: 118 | Qmax: 1981007.6481
| Reward: 11239.6894 | Episode: 119 | Qmax: 2102178.4670
| Reward: 11239.3277 | Episode: 120 | Qmax: 2223618.2503
| Reward: 11238.5179 | Episode: 121 | Qmax: 2346494.4938
| Reward: 11239.2375 | Episode: 122 | Qmax: 2473204.3824
| Reward: 11238.9990 | Episode: 123 | Qmax: 2599945.1367
| Reward: 11239.3074 | Episode: 124 | Qmax: 2726478.2904
| Reward: 11238.9057 | Episode: 125 | Qmax: 2848762.4878
| Reward: 11239.1954 | Episode: 126 | Qmax: 2969314.8549
| Reward: 11238.9461 | Episode: 127 | Qmax: 3129546.8654
| Reward: 11239.4344 | Episode: 128 | Qmax: 3288355.8024
| Reward: 11238.8576 | Episode: 129 | Qmax: 3450953.5251
| Reward: 11238.8233 | Episode: 130 | Qmax: 3619569.9032
| Reward: 11238.9973 | Episode: 131 | Qmax: 3805553.0754
| Reward: 11239.1524 | Episode: 132 | Qmax: 4001566.6193
| Reward: 11238.7042 | Episode: 133 | Qmax: 4194013.9962
| Reward: 11238.8206 | Episode: 134 | Qmax: 4394253.1255
| Reward: 11239.1611 | Episode: 135 | Qmax: 4609027.6793
| Reward: 11238.5142 | Episode: 136 | Qmax: 4813778.0972
| Reward: 11238.4028 | Episode: 137 | Qmax: 5022904.3438
| Reward: 11238.8348 | Episode: 138 | Qmax: 5231063.6106
| Reward: 11239.1209 | Episode: 139 | Qmax: 5435154.1810
| Reward: 11238.9000 | Episode: 140 | Qmax: 5645123.2366
| Reward: 11238.1460 | Episode: 141 | Qmax: 5861376.8544
| Reward: 11238.7972 | Episode: 142 | Qmax: 6083422.3293
| Reward: 11239.0234 | Episode: 143 | Qmax: 6327909.2843
| Reward: 11239.0804 | Episode: 144 | Qmax: 6562122.6281
| Reward: 11239.1988 | Episode: 145 | Qmax: 6802852.9011
| Reward: 11239.2884 | Episode: 146 | Qmax: 7044171.0752
| Reward: 11239.3183 | Episode: 147 | Qmax: 7294586.3760
| Reward: 11238.9871 | Episode: 148 | Qmax: 7583983.0714
| Reward: 11238.8778 | Episode: 149 | Qmax: 7883316.4200
| Reward: 11239.2683 | Episode: 150 | Qmax: 8179163.2802
| Reward: 11238.6914 | Episode: 151 | Qmax: 8469418.7734
| Reward: 11239.1072 | Episode: 152 | Qmax: 8791701.0780
| Reward: 11238.8348 | Episode: 153 | Qmax: 9097719.6892
| Reward: 11238.9272 | Episode: 154 | Qmax: 9395136.2823
| Reward: 11238.9914 | Episode: 155 | Qmax: 9724936.6793
| Reward: 11239.0060 | Episode: 156 | Qmax: 10042742.4073
| Reward: 11239.2915 | Episode: 157 | Qmax: 10333052.5529
| Reward: 11238.9725 | Episode: 158 | Qmax: 10591494.1154
| Reward: 11239.2485 | Episode: 159 | Qmax: 10869691.1820
| Reward: 11239.6072 | Episode: 160 | Qmax: 11139830.8338
| Reward: 11239.3581 | Episode: 161 | Qmax: 11417652.4451
| Reward: 11239.2548 | Episode: 162 | Qmax: 11690004.8578
| Reward: 11239.1588 | Episode: 163 | Qmax: 11974962.2212
| Reward: 11239.0420 | Episode: 164 | Qmax: 12253233.8029
| Reward: 11238.2301 | Episode: 165 | Qmax: 12550253.0213
| Reward: 11239.3760 | Episode: 166 | Qmax: 12822579.9471
| Reward: 11238.9409 | Episode: 167 | Qmax: 13106775.6951
| Reward: 11238.7112 | Episode: 168 | Qmax: 13404073.4643
| Reward: 11239.0350 | Episode: 169 | Qmax: 13670021.3441
| Reward: 11239.6643 | Episode: 170 | Qmax: 13974450.8963
| Reward: 11238.9983 | Episode: 171 | Qmax: 14277591.2933
| Reward: 11238.9895 | Episode: 172 | Qmax: 14609382.0845
| Reward: 11239.4284 | Episode: 173 | Qmax: 14953075.7576
| Reward: 11238.9841 | Episode: 174 | Qmax: 15316413.6078
| Reward: 11238.7525 | Episode: 175 | Qmax: 15714060.8015
| Reward: 11239.3183 | Episode: 176 | Qmax: 16128722.0302
| Reward: 11239.1141 | Episode: 177 | Qmax: 16553677.8565
| Reward: 11238.5715 | Episode: 178 | Qmax: 17021602.9492
| Reward: 11239.3031 | Episode: 179 | Qmax: 17480253.8777
| Reward: 11239.7548 | Episode: 180 | Qmax: 17929214.5185
| Reward: 11239.1719 | Episode: 181 | Qmax: 18469962.6140
| Reward: 11239.5590 | Episode: 182 | Qmax: 18982113.9066
| Reward: 11239.2798 | Episode: 183 | Qmax: 19475414.3420
| Reward: 11239.1344 | Episode: 184 | Qmax: 19992308.5783
| Reward: 11238.6732 | Episode: 185 | Qmax: 20514041.5893
| Reward: 11239.3227 | Episode: 186 | Qmax: 21038867.2418
| Reward: 11239.2199 | Episode: 187 | Qmax: 21534117.3695
| Reward: 11239.0889 | Episode: 188 | Qmax: 22059249.8242
| Reward: 11238.9479 | Episode: 189 | Qmax: 22569718.7390
| Reward: 11239.2209 | Episode: 190 | Qmax: 23052030.8846
| Reward: 11239.1827 | Episode: 191 | Qmax: 23498431.7734
| Reward: 11239.2463 | Episode: 192 | Qmax: 23910945.2157
| Reward: 11239.0258 | Episode: 193 | Qmax: 24313549.9423
| Reward: 11238.9578 | Episode: 194 | Qmax: 24685660.0838
| Reward: 11238.6249 | Episode: 195 | Qmax: 25072054.6360
| Reward: 11239.3298 | Episode: 196 | Qmax: 25373165.9464
| Reward: 11239.1920 | Episode: 197 | Qmax: 25686500.0206
| Reward: 11239.3100 | Episode: 198 | Qmax: 26026040.4299
| Reward: 11238.6891 | Episode: 199 | Qmax: 26340542.0673
saving weights
Plotting an new testing environment
