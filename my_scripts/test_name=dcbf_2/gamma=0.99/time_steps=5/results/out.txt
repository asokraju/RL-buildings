summary_dir /afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=5
use_gpu True
save_model True
load_model False
random_seed 1754
buffer_size 1000000
max_episodes 200
max_episode_len 1464
mini_batch_size 300
actor_lr 0.0001
critic_lr 0.001
gamma 0.99
noise_var 0.0925
scaling True
state_dim 2
action_dim 1
action_bound [1.]
discretization_time 0.001
T_set_max_min [23.0, 26.0]
T_max_min [22.0, 25.0]
time_steps 5
actor_rnn 10
actor_l1 50
actor_l2 40
critic_rnn 10
critic_l1 50
critic_l2 20
tau 0.001
{'T_max_min': [22.0, 25.0],
 'T_set_max_min': [23.0, 26.0],
 'action_bound': array([1.], dtype=float32),
 'action_dim': 1,
 'actor_l1': 50,
 'actor_l2': 40,
 'actor_lr': 0.0001,
 'actor_rnn': 10,
 'buffer_size': 1000000,
 'critic_l1': 50,
 'critic_l2': 20,
 'critic_lr': 0.001,
 'critic_rnn': 10,
 'discretization_time': 0.001,
 'gamma': 0.99,
 'load_model': False,
 'max_episode_len': 1464,
 'max_episodes': 200,
 'mini_batch_size': 300,
 'noise_var': 0.0925,
 'random_seed': 1754,
 'save_model': True,
 'scaling': True,
 'state_dim': 2,
 'summary_dir': '/afs/crc.nd.edu/user/k/kkosaraj/GITHUB_BUILD_1/my_scripts/test_name=dcbf_2/gamma=0.99/time_steps=5',
 'tau': 0.001,
 'time_steps': 5,
 'use_gpu': True}
starting the scaling
finished the scaling
[0.47795428 0.02820939] [ 23.98803065 -28.59003132]
initalizing the actor and critic func
loading the weights
Model: "actor_network"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
actor_input_state (InputLaye [(None, 5, 2)]            0         
_________________________________________________________________
conv1d (Conv1D)              (None, 4, 16)             80        
_________________________________________________________________
actor_rnn (GRU)              (None, 10)                840       
_________________________________________________________________
actor_dense_1 (Dense)        (None, 50)                550       
_________________________________________________________________
batch_normalization (BatchNo (None, 50)                200       
_________________________________________________________________
activation (Activation)      (None, 50)                0         
_________________________________________________________________
actor_dense_2 (Dense)        (None, 40)                2040      
_________________________________________________________________
batch_normalization_1 (Batch (None, 40)                160       
_________________________________________________________________
activation_1 (Activation)    (None, 40)                0         
_________________________________________________________________
actor_dense_3 (Dense)        (None, 1)                 41        
_________________________________________________________________
tf_op_layer_actions_scaling  [(None, 1)]               0         
=================================================================
Total params: 3,911
Trainable params: 3,731
Non-trainable params: 180
_________________________________________________________________
None
Model: "critic_network"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
critic_input_state (InputLayer) [(None, 5, 2)]       0                                            
__________________________________________________________________________________________________
conv1d_2 (Conv1D)               (None, 4, 16)        80          critic_input_state[0][0]         
__________________________________________________________________________________________________
gru (GRU)                       (None, 10)           840         conv1d_2[0][0]                   
__________________________________________________________________________________________________
critic_dense_1 (Dense)          (None, 50)           550         gru[0][0]                        
__________________________________________________________________________________________________
batch_normalization_4 (BatchNor (None, 50)           200         critic_dense_1[0][0]             
__________________________________________________________________________________________________
activation_4 (Activation)       (None, 50)           0           batch_normalization_4[0][0]      
__________________________________________________________________________________________________
critic_input_action (InputLayer [(None, 1)]          0                                            
__________________________________________________________________________________________________
critic_dense_2_state (Dense)    (None, 20)           1020        activation_4[0][0]               
__________________________________________________________________________________________________
critic_dense_2_action (Dense)   (None, 20)           40          critic_input_action[0][0]        
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 40)           0           critic_dense_2_state[0][0]       
                                                                 critic_dense_2_action[0][0]      
__________________________________________________________________________________________________
critic_dense_3_state (Dense)    (None, 20)           820         concatenate[0][0]                
__________________________________________________________________________________________________
batch_normalization_5 (BatchNor (None, 20)           80          critic_dense_3_state[0][0]       
__________________________________________________________________________________________________
activation_5 (Activation)       (None, 20)           0           batch_normalization_5[0][0]      
__________________________________________________________________________________________________
Q_val (Dense)                   (None, 1)            21          activation_5[0][0]               
==================================================================================================
Total params: 3,651
Trainable params: 3,511
Non-trainable params: 140
__________________________________________________________________________________________________
None
starting the simulation
running - train_rnn_cbf
| Reward: 10078.2999 | Episode: 0 | Qmax: 9.0365
| Reward: 10376.0917 | Episode: 1 | Qmax: 19.3562
| Reward: 11247.9367 | Episode: 2 | Qmax: 35.4744
| Reward: 11249.0356 | Episode: 3 | Qmax: 55.0077
| Reward: 11248.7266 | Episode: 4 | Qmax: 76.3554
| Reward: 11248.3959 | Episode: 5 | Qmax: 97.2176
| Reward: 11248.4776 | Episode: 6 | Qmax: 115.7335
| Reward: 11249.4123 | Episode: 7 | Qmax: 132.7260
| Reward: 11248.4992 | Episode: 8 | Qmax: 150.7384
| Reward: 11248.5409 | Episode: 9 | Qmax: 166.9940
| Reward: 11248.7210 | Episode: 10 | Qmax: 180.7160
| Reward: 11248.9632 | Episode: 11 | Qmax: 191.6277
| Reward: 11248.6669 | Episode: 12 | Qmax: 200.2591
| Reward: 11249.0043 | Episode: 13 | Qmax: 208.4530
| Reward: 11248.8031 | Episode: 14 | Qmax: 218.1876
| Reward: 11248.6650 | Episode: 15 | Qmax: 228.5860
| Reward: 11248.5906 | Episode: 16 | Qmax: 238.8422
| Reward: 11249.0344 | Episode: 17 | Qmax: 248.2617
| Reward: 11248.2723 | Episode: 18 | Qmax: 257.1790
| Reward: 11248.9006 | Episode: 19 | Qmax: 265.7907
| Reward: 11248.4472 | Episode: 20 | Qmax: 274.4036
| Reward: 11248.7262 | Episode: 21 | Qmax: 283.3985
| Reward: 11248.8341 | Episode: 22 | Qmax: 292.5246
| Reward: 11248.6618 | Episode: 23 | Qmax: 301.5547
| Reward: 11248.3519 | Episode: 24 | Qmax: 310.4726
| Reward: 11248.4495 | Episode: 25 | Qmax: 319.1231
| Reward: 11248.7733 | Episode: 26 | Qmax: 327.2570
| Reward: 11248.9036 | Episode: 27 | Qmax: 335.0129
| Reward: 11248.4173 | Episode: 28 | Qmax: 341.8688
| Reward: 11248.7835 | Episode: 29 | Qmax: 348.5112
| Reward: 11249.3913 | Episode: 30 | Qmax: 354.3667
| Reward: 11248.9000 | Episode: 31 | Qmax: 360.3134
| Reward: 11248.3229 | Episode: 32 | Qmax: 365.8315
| Reward: 11248.3930 | Episode: 33 | Qmax: 371.3197
| Reward: 11248.2907 | Episode: 34 | Qmax: 376.9890
| Reward: 11248.4841 | Episode: 35 | Qmax: 382.5159
| Reward: 11248.4233 | Episode: 36 | Qmax: 387.9827
| Reward: 11248.3591 | Episode: 37 | Qmax: 393.7344
| Reward: 11248.2900 | Episode: 38 | Qmax: 399.6912
| Reward: 11248.6055 | Episode: 39 | Qmax: 405.4960
| Reward: 11248.6252 | Episode: 40 | Qmax: 411.2879
| Reward: 11248.0574 | Episode: 41 | Qmax: 417.2066
| Reward: 11248.6892 | Episode: 42 | Qmax: 422.8703
| Reward: 11249.0872 | Episode: 43 | Qmax: 428.5277
| Reward: 11248.0310 | Episode: 44 | Qmax: 434.0605
| Reward: 11248.7153 | Episode: 45 | Qmax: 439.6735
| Reward: 11248.8779 | Episode: 46 | Qmax: 444.9045
| Reward: 11248.9679 | Episode: 47 | Qmax: 449.9948
| Reward: 11248.9498 | Episode: 48 | Qmax: 454.8453
| Reward: 11248.5991 | Episode: 49 | Qmax: 459.5683
| Reward: 11249.2683 | Episode: 50 | Qmax: 464.0760
| Reward: 11247.9378 | Episode: 51 | Qmax: 468.6726
| Reward: 11248.4693 | Episode: 52 | Qmax: 473.0927
| Reward: 11248.8833 | Episode: 53 | Qmax: 477.4005
| Reward: 11248.6506 | Episode: 54 | Qmax: 481.5184
| Reward: 11249.1403 | Episode: 55 | Qmax: 485.8040
| Reward: 11248.7865 | Episode: 56 | Qmax: 490.3229
| Reward: 11248.7397 | Episode: 57 | Qmax: 494.6001
| Reward: 11248.7287 | Episode: 58 | Qmax: 498.8581
| Reward: 11249.0946 | Episode: 59 | Qmax: 502.7829
| Reward: 11249.3802 | Episode: 60 | Qmax: 506.4498
| Reward: 11248.8537 | Episode: 61 | Qmax: 510.5338
| Reward: 11248.8957 | Episode: 62 | Qmax: 514.3288
| Reward: 11249.1308 | Episode: 63 | Qmax: 518.7083
| Reward: 11248.3807 | Episode: 64 | Qmax: 523.6748
| Reward: 11249.1524 | Episode: 65 | Qmax: 527.3108
| Reward: 11249.2782 | Episode: 66 | Qmax: 532.8678
| Reward: 11248.9860 | Episode: 67 | Qmax: 538.8508
| Reward: 11248.9601 | Episode: 68 | Qmax: 545.1549
| Reward: 11248.3729 | Episode: 69 | Qmax: 549.2076
| Reward: 11248.2169 | Episode: 70 | Qmax: 552.7091
| Reward: 11248.8826 | Episode: 71 | Qmax: 557.0189
| Reward: 11249.1523 | Episode: 72 | Qmax: 560.3255
| Reward: 11249.0098 | Episode: 73 | Qmax: 563.9058
| Reward: 11248.8259 | Episode: 74 | Qmax: 567.1911
| Reward: 11248.3851 | Episode: 75 | Qmax: 570.1829
| Reward: 11249.0969 | Episode: 76 | Qmax: 574.1139
| Reward: 11249.2617 | Episode: 77 | Qmax: 577.2582
| Reward: 11249.1247 | Episode: 78 | Qmax: 578.6163
| Reward: 11248.0864 | Episode: 79 | Qmax: 581.6364
| Reward: 11248.6691 | Episode: 80 | Qmax: 585.9857
| Reward: 11248.6460 | Episode: 81 | Qmax: 590.5562
| Reward: 11248.6757 | Episode: 82 | Qmax: 594.6844
| Reward: 11249.1184 | Episode: 83 | Qmax: 598.3848
| Reward: 11248.6263 | Episode: 84 | Qmax: 603.0418
| Reward: 11248.7491 | Episode: 85 | Qmax: 607.8960
| Reward: 11248.7768 | Episode: 86 | Qmax: 609.8032
| Reward: 11249.0790 | Episode: 87 | Qmax: 608.1839
| Reward: 11248.7241 | Episode: 88 | Qmax: 608.6822
| Reward: 11248.6371 | Episode: 89 | Qmax: 610.4467
| Reward: 11248.2408 | Episode: 90 | Qmax: 610.4535
| Reward: 11248.7155 | Episode: 91 | Qmax: 611.2313
| Reward: 11249.0728 | Episode: 92 | Qmax: 613.9491
| Reward: 11248.4427 | Episode: 93 | Qmax: 617.1111
| Reward: 11248.7382 | Episode: 94 | Qmax: 619.0902
| Reward: 11248.4472 | Episode: 95 | Qmax: 622.4001
| Reward: 11248.9103 | Episode: 96 | Qmax: 625.8449
| Reward: 11248.8452 | Episode: 97 | Qmax: 628.6899
| Reward: 11248.5999 | Episode: 98 | Qmax: 630.7424
| Reward: 11249.0736 | Episode: 99 | Qmax: 632.2663
| Reward: 11248.2774 | Episode: 100 | Qmax: 635.0151
| Reward: 11248.9676 | Episode: 101 | Qmax: 636.6750
| Reward: 11248.5754 | Episode: 102 | Qmax: 638.3250
| Reward: 11248.3160 | Episode: 103 | Qmax: 639.7203
| Reward: 11248.7803 | Episode: 104 | Qmax: 642.1885
| Reward: 11249.4289 | Episode: 105 | Qmax: 644.0882
| Reward: 11249.1731 | Episode: 106 | Qmax: 644.6983
| Reward: 11248.2798 | Episode: 107 | Qmax: 644.8622
| Reward: 11248.8517 | Episode: 108 | Qmax: 644.4565
| Reward: 11248.4637 | Episode: 109 | Qmax: 646.0283
| Reward: 11248.9118 | Episode: 110 | Qmax: 648.1029
| Reward: 11248.3444 | Episode: 111 | Qmax: 651.3170
| Reward: 11248.4265 | Episode: 112 | Qmax: 655.2128
| Reward: 11248.6071 | Episode: 113 | Qmax: 658.1998
| Reward: 11248.8184 | Episode: 114 | Qmax: 670.0009
| Reward: 11248.6929 | Episode: 115 | Qmax: 683.8264
| Reward: 11248.1429 | Episode: 116 | Qmax: 698.8708
| Reward: 11248.4025 | Episode: 117 | Qmax: 715.8070
| Reward: 11248.7162 | Episode: 118 | Qmax: 738.1918
| Reward: 11248.7819 | Episode: 119 | Qmax: 774.5681
| Reward: 11248.3562 | Episode: 120 | Qmax: 820.4055
| Reward: 11248.8510 | Episode: 121 | Qmax: 867.3106
| Reward: 11248.7383 | Episode: 122 | Qmax: 901.8609
| Reward: 11248.9352 | Episode: 123 | Qmax: 929.9324
| Reward: 11248.7187 | Episode: 124 | Qmax: 947.2065
| Reward: 11248.8701 | Episode: 125 | Qmax: 966.4846
| Reward: 11248.2869 | Episode: 126 | Qmax: 983.3749
| Reward: 11248.0094 | Episode: 127 | Qmax: 985.9166
| Reward: 11249.1211 | Episode: 128 | Qmax: 989.8057
| Reward: 11248.6659 | Episode: 129 | Qmax: 989.9654
| Reward: 11248.2114 | Episode: 130 | Qmax: 987.4856
| Reward: 11248.6099 | Episode: 131 | Qmax: 983.1712
| Reward: 11248.2097 | Episode: 132 | Qmax: 978.4489
| Reward: 11247.9189 | Episode: 133 | Qmax: 972.8318
| Reward: 11248.2432 | Episode: 134 | Qmax: 967.6189
| Reward: 11248.8299 | Episode: 135 | Qmax: 959.5882
| Reward: 11248.2400 | Episode: 136 | Qmax: 949.4489
| Reward: 11248.5756 | Episode: 137 | Qmax: 936.0144
| Reward: 11248.4236 | Episode: 138 | Qmax: 917.3507
| Reward: 11248.6515 | Episode: 139 | Qmax: 893.2838
| Reward: 11248.8292 | Episode: 140 | Qmax: 866.4267
| Reward: 11248.8184 | Episode: 141 | Qmax: 836.3043
| Reward: 11249.3357 | Episode: 142 | Qmax: 811.4397
| Reward: 11248.5257 | Episode: 143 | Qmax: 786.9340
| Reward: 11248.9239 | Episode: 144 | Qmax: 763.5709
| Reward: 11248.4974 | Episode: 145 | Qmax: 739.8568
| Reward: 11248.5767 | Episode: 146 | Qmax: 717.7444
| Reward: 11248.5119 | Episode: 147 | Qmax: 695.0701
| Reward: 11248.6909 | Episode: 148 | Qmax: 675.1543
| Reward: 11248.1452 | Episode: 149 | Qmax: 657.8483
| Reward: 11248.7400 | Episode: 150 | Qmax: 644.8808
| Reward: 11249.2724 | Episode: 151 | Qmax: 632.2360
| Reward: 11248.9372 | Episode: 152 | Qmax: 621.1443
| Reward: 11249.0415 | Episode: 153 | Qmax: 609.4891
| Reward: 11248.1728 | Episode: 154 | Qmax: 599.5153
| Reward: 11248.6105 | Episode: 155 | Qmax: 590.0416
| Reward: 11248.8982 | Episode: 156 | Qmax: 582.6047
| Reward: 11249.0408 | Episode: 157 | Qmax: 580.4948
| Reward: 11248.7990 | Episode: 158 | Qmax: 579.1738
| Reward: 11248.5291 | Episode: 159 | Qmax: 580.1524
| Reward: 11248.8180 | Episode: 160 | Qmax: 585.0082
| Reward: 11248.5516 | Episode: 161 | Qmax: 594.7483
| Reward: 11248.9209 | Episode: 162 | Qmax: 604.7809
| Reward: 11248.6962 | Episode: 163 | Qmax: 614.5022
| Reward: 11248.9758 | Episode: 164 | Qmax: 624.2054
| Reward: 11248.8853 | Episode: 165 | Qmax: 629.6639
| Reward: 11248.5502 | Episode: 166 | Qmax: 632.1583
| Reward: 11248.6610 | Episode: 167 | Qmax: 632.7038
| Reward: 11248.8764 | Episode: 168 | Qmax: 632.9545
| Reward: 11249.0393 | Episode: 169 | Qmax: 635.9142
| Reward: 11248.3332 | Episode: 170 | Qmax: 638.3160
| Reward: 11249.0926 | Episode: 171 | Qmax: 636.3549
| Reward: 11249.0213 | Episode: 172 | Qmax: 632.5179
| Reward: 11249.4790 | Episode: 173 | Qmax: 626.9581
| Reward: 11248.7677 | Episode: 174 | Qmax: 622.6587
| Reward: 11249.0820 | Episode: 175 | Qmax: 622.5570
| Reward: 11248.7589 | Episode: 176 | Qmax: 623.4089
| Reward: 11248.2511 | Episode: 177 | Qmax: 628.8294
| Reward: 11248.1325 | Episode: 178 | Qmax: 638.0123
| Reward: 11248.4908 | Episode: 179 | Qmax: 646.2167
| Reward: 11249.0923 | Episode: 180 | Qmax: 650.0219
| Reward: 11248.6956 | Episode: 181 | Qmax: 652.8878
| Reward: 11248.6776 | Episode: 182 | Qmax: 657.5108
| Reward: 11248.8756 | Episode: 183 | Qmax: 664.1951
| Reward: 11249.2058 | Episode: 184 | Qmax: 672.3571
| Reward: 11248.9957 | Episode: 185 | Qmax: 686.0550
| Reward: 11248.6132 | Episode: 186 | Qmax: 700.7746
| Reward: 11248.2847 | Episode: 187 | Qmax: 709.0924
| Reward: 11248.7888 | Episode: 188 | Qmax: 722.1582
| Reward: 11248.5705 | Episode: 189 | Qmax: 732.4668
| Reward: 11248.7172 | Episode: 190 | Qmax: 742.4601
| Reward: 11248.2715 | Episode: 191 | Qmax: 751.6427
| Reward: 11248.5804 | Episode: 192 | Qmax: 758.9986
| Reward: 11248.4090 | Episode: 193 | Qmax: 761.1905
| Reward: 11248.4576 | Episode: 194 | Qmax: 764.2205
| Reward: 11248.3041 | Episode: 195 | Qmax: 765.8954
| Reward: 11248.4903 | Episode: 196 | Qmax: 770.4680
| Reward: 11249.3067 | Episode: 197 | Qmax: 775.5608
| Reward: 11248.6871 | Episode: 198 | Qmax: 781.5626
| Reward: 11248.9787 | Episode: 199 | Qmax: 788.6087
saving weights
Plotting an new testing environment
